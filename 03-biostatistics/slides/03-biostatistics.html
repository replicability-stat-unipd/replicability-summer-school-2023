<!DOCTYPE html>
<html lang="en"><head>
<script src="03-biostatistics_files/libs/clipboard/clipboard.min.js"></script>
<script src="03-biostatistics_files/libs/quarto-html/tabby.min.js"></script>
<script src="03-biostatistics_files/libs/quarto-html/popper.min.js"></script>
<script src="03-biostatistics_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="03-biostatistics_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="03-biostatistics_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="03-biostatistics_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="03-biostatistics_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="03-biostatistics_files/libs/quarto-contrib/jquery-3.6.3/jquery-3.6.3.min.js"></script>
<script src="03-biostatistics_files/libs/quarto-contrib/code-fullscreen-1.0.0/code-fullscreen.js" defer="true"></script>
<link href="03-biostatistics_files/libs/quarto-contrib/code-fullscreen-1.0.0/code-fullscreen.css" rel="stylesheet"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <meta charset="utf-8">
  <meta name="generator" content="quarto-1.3.450">

  <meta name="author" content="Filippo Gambarota">
  <meta name="author" content="Gianmarco Altoè">
  <title>Exploring Replicability in Biostatistics</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="03-biostatistics_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="03-biostatistics_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
  <link rel="stylesheet" href="03-biostatistics_files/libs/revealjs/dist/theme/quarto.css">
  <link href="03-biostatistics_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="03-biostatistics_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="03-biostatistics_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="03-biostatistics_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  
  <script src="03-biostatistics_files/libs/kePrint-0.0.1/kePrint.js"></script>
  <link href="03-biostatistics_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Exploring Replicability in Biostatistics</h1>
  <p class="subtitle">Replicability Crisis in Science?</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Filippo Gambarota <a href="https://orcid.org/0000-0002-6666-1747" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a>
</div>
<div class="quarto-title-author-email">
<a href="mailto:filippo.gambarota@unipd.it">filippo.gambarota@unipd.it</a>
</div>
</div>
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Gianmarco Altoè <a href="https://orcid.org/0000-0003-1154-9528" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a>
</div>
<div class="quarto-title-author-email">
<a href="mailto:gianmarco.altoe@unipd.it">gianmarco.altoe@unipd.it</a>
</div>
</div>
</div>

  <p class="date">18-22 September 2023</p>
</section><section id="TOC">
<nav role="doc-toc"> 
<h2 id="toc-title">Table of contents</h2>
<ul>
<li><a href="#/replicability-in-biostatistics" id="/toc-replicability-in-biostatistics">Replicability in Biostatistics</a></li>
<li><a href="#/background" id="/toc-background">Background</a></li>
<li><a href="#/application-to-genetic-data" id="/toc-application-to-genetic-data">Application to genetic data</a></li>
</ul>
</nav>
</section>

<section id="setup-r" class="slide level2">
<h2>Setup R</h2>
<h3 id="packages">Packages</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># for data manipulation</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">library</span>(curatedOvarianData) <span class="co"># workshop data</span></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">library</span>(pROC)</span>
<span id="cb1-4"><a href="#cb1-4"></a>devtools<span class="sc">::</span><span class="fu">load_all</span>() <span class="co"># load all functions for the workshop</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<h3 id="loading-data">Loading Data</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>datl <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"03-biostatistics"</span>, <span class="st">"objects"</span>, <span class="st">"ovarianclean.rds"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section>
<section id="replicability-in-biostatistics" class="title-slide slide level1 section center">
<h1>Replicability in Biostatistics</h1>

</section>
<section id="replicability-in-biostatistics-1" class="slide level2">
<h2>Replicability in Biostatistics</h2>
<ul>
<li>In <em>Biostatistics</em> is common to have a similar experimental setup (i.e., same genes and variables), repeated across multiple studies. Replicability in this framework refer to how consistent is a variable (e.g., gene expression) in predicting a certain outcome across different dataset.</li>
</ul>
<div class="fragment">
<ul>
<li>Recent research suggest the importance of cross-study training of prediction models to improve the overall predictive performance and replicability <span class="citation" data-cites="Patil2018-hm Parmigiani2023-dr Masoero2023-wb">(<a href="#/references-download-.bib-file" role="doc-biblioref" onclick="">Masoero et al., 2023</a>; <a href="#/references-download-.bib-file" role="doc-biblioref" onclick="">Parmigiani, 2023</a>; <a href="#/references-download-.bib-file" role="doc-biblioref" onclick="">Patil &amp; Parmigiani, 2018</a>)</span></li>
</ul>
</div>
<div class="fragment">
<ul>
<li>We will try to assess how a certain variable consistently (or not) predict a certain outcome using a binary classification and meta-analytic approach</li>
</ul>
</div>
</section></section>
<section>
<section id="background" class="title-slide slide level1 section center">
<h1>Background</h1>

</section>
<section id="background-1" class="slide level2">
<h2>Background</h2>
<p>For this lecture we will use:</p>
<ul>
<li><strong>Gene expression</strong> data</li>
<li>Analysis of <strong>contingency tables</strong></li>
<li><strong>Binary classifiers</strong></li>
<li><strong>Receiver Operating Characteristic</strong> (ROC) curves</li>
<li>The <strong>Youden index</strong> to analyze ROC curves</li>
</ul>
</section>
<section id="genes-expression-data" class="slide level2">
<h2>Genes expression data</h2>
<p>We are going to use the <code>curatedOvarianData</code> dataset <span class="citation" data-cites="Waldron2014-yv">(see <a href="#/references-download-.bib-file" role="doc-biblioref" onclick="">Waldron et al., 2014</a> for details)</span>. Ganzfried <span class="citation" data-cites="Ganzfried2013-ut">(<a href="#/references-download-.bib-file" role="doc-biblioref" onclick="">2013</a>)</span> provide a detailed description of the dataset structure.</p>
<div class="cell" data-layout-align="center">
<iframe src="https://bioconductor.org/packages/release/data/experiment/html/curatedOvarianData.html" width="960" height="400px" data-external="1">
</iframe>
</div>
</section>
<section id="data-structure" class="slide level2">
<h2>Data structure</h2>
<p>Gene <strong>Expression</strong> data are very complex in terms of acquisition, pre-processing and organization. For the purpose of this workshop we will transform the gene-phenotype database in a standard 2d dataframe using the <code>get_bio_data()</code> function. The majority of packages that we are going to use works better with this data structure.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>get_bio_data <span class="ot">&lt;-</span> <span class="cf">function</span>(data, gene, phenotype){</span>
<span id="cb3-2"><a href="#cb3-2"></a>  phend <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Biobase<span class="sc">::</span><span class="fu">pData</span>(data)[, phenotype])</span>
<span id="cb3-3"><a href="#cb3-3"></a>  gened <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Biobase<span class="sc">::</span><span class="fu">exprs</span>(data)[gene, ])</span>
<span id="cb3-4"><a href="#cb3-4"></a>  <span class="cf">if</span>(<span class="fu">length</span>(gene) <span class="sc">!=</span> <span class="dv">1</span>){</span>
<span id="cb3-5"><a href="#cb3-5"></a>    gened <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">t</span>(gened))</span>
<span id="cb3-6"><a href="#cb3-6"></a>  }</span>
<span id="cb3-7"><a href="#cb3-7"></a>  out <span class="ot">&lt;-</span> <span class="fu">cbind</span>(phend, gened)</span>
<span id="cb3-8"><a href="#cb3-8"></a>  <span class="fu">colnames</span>(out) <span class="ot">&lt;-</span> <span class="fu">c</span>(phenotype, gene)</span>
<span id="cb3-9"><a href="#cb3-9"></a>  <span class="fu">rownames</span>(out) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb3-10"><a href="#cb3-10"></a>  <span class="fu">return</span>(out)</span>
<span id="cb3-11"><a href="#cb3-11"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-structure-1" class="slide level2">
<h2>Data structure</h2>
<p>All the datasets are available using the <code>data(dataset, package = "curatedOvarianData")</code>. To see a list of available datasets (when the package is loaded using <code>library()</code> the <code>package =</code> argument can be omitted):</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="fu">data</span>(<span class="at">package =</span> <span class="st">"curatedOvarianData"</span>)<span class="sc">$</span>result[, <span class="st">"Item"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "E.MTAB.386_eset"         "GSE12418_eset"          
 [3] "GSE12470_eset"           "GSE13876_eset"          
 [5] "GSE14764_eset"           "GSE17260_eset"          
 [7] "GSE18520_eset"           "GSE19829.GPL570_eset"   
 [9] "GSE19829.GPL8300_eset"   "GSE20565_eset"          
[11] "GSE2109_eset"            "GSE26193_eset"          
[13] "GSE26712_eset"           "GSE30009_eset"          
[15] "GSE30161_eset"           "GSE32062.GPL6480_eset"  
[17] "GSE32063_eset"           "GSE44104_eset"          
[19] "GSE49997_eset"           "GSE51088_eset"          
[21] "GSE6008_eset"            "GSE6822_eset"           
[23] "GSE8842_eset"            "GSE9891_eset"           
[25] "PMID15897565_eset"       "PMID17290060_eset"      
[27] "PMID19318476_eset"       "TCGA.RNASeqV2_eset"     
[29] "TCGA.mirna.8x15kv2_eset" "TCGA_eset"              </code></pre>
</div>
</div>
</section>
<section id="data-structure-2" class="slide level2">
<h2>Data structure</h2>
<p>For example, we want to extract the <code>ARHGAP5</code> and <code>ZNF487</code> <em>genes</em> and <code>debulking</code> and <code>tumorstage</code> <em>phenotype</em> variables.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="fu">data</span>(GSE32063_eset) <span class="co"># load the dataset</span></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="fu">get_bio_data</span>(GSE32063_eset, <span class="fu">c</span>(<span class="st">"ARHGAP5"</span>, <span class="st">"ZNF487"</span>), <span class="fu">c</span>(<span class="st">"debulking"</span>, <span class="st">"tumorstage"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    debulking tumorstage    ARHGAP5     ZNF487
1  suboptimal          3 -1.3788404 -1.4693060
2     optimal          3 -0.7029762 -2.1866198
3  suboptimal          3 -1.1906614 -1.5242004
4  suboptimal          3 -1.5408096 -1.9636803
5  suboptimal          3 -1.8204670 -1.6253910
6     optimal          3 -0.1023159 -0.9768720
7  suboptimal          4 -1.4978333 -2.8806515
8     optimal          4 -0.3169098 -0.9902863
9     optimal          3 -0.9621868 -1.2781801
10 suboptimal          3 -2.6246548 -2.3127084
11 suboptimal          3 -1.1208530 -1.3294687
12 suboptimal          3 -1.6579170 -3.5191045
13 suboptimal          4 -1.7063255 -1.0643783
14    optimal          3 -1.2869992 -1.2185640
15 suboptimal          3 -2.5078154 -1.6630969
16 suboptimal          4 -1.0130329 -1.6677127
17 suboptimal          3 -2.3309345 -2.7753735
18 suboptimal          3 -2.4601330 -1.0582757
19    optimal          3 -1.7182579 -1.4094768
20    optimal          3 -1.3721395 -1.7538829
21    optimal          4 -1.0870414 -1.6791105
22    optimal          3 -0.7623720 -1.4829173
23 suboptimal          3 -1.1356659 -2.1259017
24    optimal          3 -1.3679762 -0.1064415
25 suboptimal          4 -1.1441503 -2.5149746
26    optimal          3 -1.8230276 -0.3728800
27 suboptimal          3 -1.2220440 -2.3130960
28    optimal          3 -0.7620802 -1.6277437
29    optimal          3 -0.1756640 -1.4368038
30 suboptimal          3 -0.3513031 -1.5798197
31    optimal          3 -1.1255894 -1.3647880
32    optimal          3 -1.2265711 -1.5709486
33    optimal          3  0.4664946 -1.0424862
34 suboptimal          4 -1.8461108 -2.3798810
35    optimal          3 -1.7979369 -0.7189474
36 suboptimal          3 -1.6521063 -1.7661219
37    optimal          3 -2.3519936 -0.6084919
38    optimal          3 -2.1397367 -0.6968164
39 suboptimal          4 -1.6583776 -2.9544182
40 suboptimal          4 -1.6778574 -3.0424485</code></pre>
</div>
</div>
</section>
<section id="data-structure-3" class="slide level2">
<h2>Data structure</h2>
<p>We performed a little bit of pre-processing to have a more clean and minimal dataset. The pre-processing are described into the <code>03-biostatistics/scripts/gene-data-preprocessing.R</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="fu">library</span>(curatedOvarianData)</span>
<span id="cb8-2"><a href="#cb8-2"></a>devtools<span class="sc">::</span><span class="fu">load_all</span>()</span>
<span id="cb8-3"><a href="#cb8-3"></a></span>
<span id="cb8-4"><a href="#cb8-4"></a>listdata <span class="ot">&lt;-</span> <span class="fu">data</span>(<span class="at">package =</span> <span class="st">"curatedOvarianData"</span>)<span class="sc">$</span>results[, <span class="st">"Item"</span>]</span>
<span id="cb8-5"><a href="#cb8-5"></a>datl <span class="ot">&lt;-</span> <span class="fu">lapply</span>(listdata, getdata, <span class="at">package =</span> <span class="st">"curatedOvarianData"</span>)</span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="fu">names</span>(datl) <span class="ot">&lt;-</span> listdata</span>
<span id="cb8-7"><a href="#cb8-7"></a></span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="co"># we need the debulking as phenotype, lets see which data have it</span></span>
<span id="cb8-9"><a href="#cb8-9"></a></span>
<span id="cb8-10"><a href="#cb8-10"></a>has_debulking <span class="ot">&lt;-</span> <span class="fu">sapply</span>(datl, <span class="cf">function</span>(d) <span class="fu">any</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="fu">pData</span>(d)[, <span class="st">"debulking"</span>])))</span>
<span id="cb8-11"><a href="#cb8-11"></a>datl_debulking <span class="ot">&lt;-</span> datl[has_debulking]</span>
<span id="cb8-12"><a href="#cb8-12"></a></span>
<span id="cb8-13"><a href="#cb8-13"></a><span class="co"># let's see how many NAs and remove the dataset with an high percentage</span></span>
<span id="cb8-14"><a href="#cb8-14"></a></span>
<span id="cb8-15"><a href="#cb8-15"></a>pNA <span class="ot">&lt;-</span> <span class="fu">sapply</span>(datl_debulking, <span class="cf">function</span>(x) <span class="fu">mean</span>(<span class="fu">is.na</span>(<span class="fu">pData</span>(x)[, <span class="st">"debulking"</span>])))</span>
<span id="cb8-16"><a href="#cb8-16"></a>ncases <span class="ot">&lt;-</span> <span class="fu">sapply</span>(datl_debulking, <span class="cf">function</span>(x) <span class="fu">length</span>(<span class="fu">pData</span>(x)[, <span class="st">"debulking"</span>]))</span>
<span id="cb8-17"><a href="#cb8-17"></a>missing <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(pNA, ncases)</span>
<span id="cb8-18"><a href="#cb8-18"></a></span>
<span id="cb8-19"><a href="#cb8-19"></a><span class="co"># remove dataset with more than 20% of NA on debulking</span></span>
<span id="cb8-20"><a href="#cb8-20"></a>datl_debulking <span class="ot">&lt;-</span> datl_debulking[pNA <span class="sc">&lt;</span> <span class="fl">0.2</span>]</span>
<span id="cb8-21"><a href="#cb8-21"></a></span>
<span id="cb8-22"><a href="#cb8-22"></a><span class="co"># let's explore the genes, we keep the genes that are in common with all</span></span>
<span id="cb8-23"><a href="#cb8-23"></a><span class="co"># datasets. One dataset the "TCGA.mirna.8x15kv2_eset" dataset has some genes that are</span></span>
<span id="cb8-24"><a href="#cb8-24"></a><span class="co"># completely different from the others, we remove it.</span></span>
<span id="cb8-25"><a href="#cb8-25"></a></span>
<span id="cb8-26"><a href="#cb8-26"></a><span class="co"># get_gene_names(datl_debulking$TCGA.mirna.8x15kv2_eset)</span></span>
<span id="cb8-27"><a href="#cb8-27"></a>datl_debulking <span class="ot">&lt;-</span> datl_debulking[<span class="fu">names</span>(datl_debulking) <span class="sc">!=</span> <span class="st">"TCGA.mirna.8x15kv2_eset"</span>]</span>
<span id="cb8-28"><a href="#cb8-28"></a></span>
<span id="cb8-29"><a href="#cb8-29"></a><span class="co"># now we intersect all the gene names to keep only the common ones</span></span>
<span id="cb8-30"><a href="#cb8-30"></a>genes <span class="ot">&lt;-</span> <span class="fu">lapply</span>(datl_debulking, get_gene_names)</span>
<span id="cb8-31"><a href="#cb8-31"></a>common_genes <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">Reduce</span>(base<span class="sc">::</span>intersect, genes)</span>
<span id="cb8-32"><a href="#cb8-32"></a></span>
<span id="cb8-33"><a href="#cb8-33"></a><span class="co"># converting into dataframe with selected </span></span>
<span id="cb8-34"><a href="#cb8-34"></a>ovarianclean <span class="ot">&lt;-</span> <span class="fu">lapply</span>(datl_debulking, get_bio_data, common_genes, <span class="st">"debulking"</span>)</span>
<span id="cb8-35"><a href="#cb8-35"></a></span>
<span id="cb8-36"><a href="#cb8-36"></a><span class="co"># saving</span></span>
<span id="cb8-37"><a href="#cb8-37"></a><span class="fu">saveRDS</span>(ovarianclean, <span class="st">"03-biostatistics/objects/ovarianclean.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-structure-4" class="slide level2">
<h2>Data structure</h2>
<p>The pre-processing create a dataframe with datasets having both the <code>debulking</code> variable and all genes in common. In this way we can analyze and compare genes among all datasets.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>datl <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"03-biostatistics"</span>, <span class="st">"objects"</span>, <span class="st">"ovarianclean.rds"</span>))</span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="fu">str</span>(datl, <span class="at">max.level =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 15
 $ E.MTAB.386_eset      :'data.frame':  129 obs. of  220 variables:
 $ GSE12418_eset        :'data.frame':  54 obs. of  220 variables:
 $ GSE17260_eset        :'data.frame':  110 obs. of  220 variables:
 $ GSE26712_eset        :'data.frame':  195 obs. of  220 variables:
 $ GSE30009_eset        :'data.frame':  103 obs. of  220 variables:
 $ GSE30161_eset        :'data.frame':  58 obs. of  220 variables:
 $ GSE32062.GPL6480_eset:'data.frame':  260 obs. of  220 variables:
 $ GSE32063_eset        :'data.frame':  40 obs. of  220 variables:
 $ GSE49997_eset        :'data.frame':  204 obs. of  220 variables:
 $ GSE9891_eset         :'data.frame':  285 obs. of  220 variables:
 $ PMID15897565_eset    :'data.frame':  63 obs. of  220 variables:
 $ PMID17290060_eset    :'data.frame':  117 obs. of  220 variables:
 $ PMID19318476_eset    :'data.frame':  42 obs. of  220 variables:
 $ TCGA.RNASeqV2_eset   :'data.frame':  261 obs. of  220 variables:
 $ TCGA_eset            :'data.frame':  578 obs. of  220 variables:</code></pre>
</div>
</div>
</section>
<section id="data-structure-5" class="slide level2">
<h2>Data structure</h2>
<p>I prefer always working (if possible) with a simple dataframe:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>dat <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(datl, <span class="at">.id =</span> <span class="st">"dataset"</span>)</span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="fu">head</span>(dat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          dataset  debulking     ABCA1    ABCA2    ABCA3    ABCA4    ABCA5
1 E.MTAB.386_eset suboptimal 10.839395 6.845599 8.962037 7.735899 6.911055
2 E.MTAB.386_eset    optimal 11.227465 7.522329 8.647420 7.257863 7.157317
3 E.MTAB.386_eset    optimal 11.375979 7.195961 8.124816 8.797894 7.076414
4 E.MTAB.386_eset    optimal  9.716625 8.253187 7.494501 7.685826 6.926470
5 E.MTAB.386_eset suboptimal 11.647426 8.300361 7.816192 7.241782 7.062383
6 E.MTAB.386_eset    optimal 10.291002 7.487264 7.788690 9.890838 7.227646
     ABCA8    ABCB1    ABCB4    ABCB7    ABCB9    ABCC1    ABCC10    ABCC4
1 8.880053 7.742924 6.858119 10.26362 7.233300 12.47511 10.621616 7.867795
2 6.705939 7.290139 6.896026 11.16421 8.294693 10.96171  9.283463 7.702067
3 7.542021 7.331410 6.729391 10.86380 7.547010 10.20072  8.884857 7.847243
4 7.827795 6.655951 6.708140 11.70487 8.637981 12.33818  9.458241 8.074573
5 6.796258 7.791991 7.488330 11.05764 8.941183 12.19990  9.561413 7.654644
6 7.586522 7.248623 6.837272 11.19498 7.516927 10.58948  9.032422 8.400274
     ABCC5     ABCC8    ABCD2    ABCD3    ABCE1    ABCF2    ABCF3     ABCG1
1 8.971456 10.368624 6.569425 6.864870 8.765213 8.405781 8.355384 12.119868
2 8.924245  7.882769 7.349124 7.035186 9.480066 9.613636 8.567225  9.533904
3 9.317958  7.240344 6.650674 6.865343 8.716176 9.322715 7.889017  9.246897
4 8.532776 10.257129 6.611022 6.761457 9.122343 9.282883 8.822519 11.375979
5 9.674851 11.258042 6.614314 6.744717 8.964149 6.764569 7.975910 12.136104
6 9.402390  7.345348 6.610154 6.916254 9.292160 9.316871 9.647487  8.672094
      ABCG4    ANXA1    ANXA4     APAF1      APC    APEX1     APEX2      APOE
1 12.644486 7.758441 6.780904  9.429752 6.659251 11.26058  9.964905 12.939256
2  8.937479 6.759182 6.843355  9.716625 6.541244 11.38137 10.379333 13.526659
3  9.032422 7.987442 6.792590  9.872901 6.756587 11.98111 10.470689  9.321591
4 11.081676 7.457984 6.699457  9.522337 6.649057 13.52122 10.019142 10.797752
5 12.316793 7.373193 6.873905 10.242153 6.733338 11.53132 10.459047 12.321970
6  9.468645 7.578365 6.858501 10.613006 6.718292 11.48385  9.947725 11.479465
      AQP9    ASAH1      ATM    ATOX1    ATP7B      ATR    AURKA       BAD
1 6.896667 8.013413 8.991016 11.86723 10.99604 8.824009 9.089473 10.026779
2 7.300790 9.384410 9.218706 11.00517 10.42616 8.869149 9.643404  9.368393
3 6.929544 8.434568 8.650290 11.14605 10.19583 9.292160 9.564038  9.157618
4 6.754185 7.994920 9.151488 10.36164 11.95049 9.364890 9.245179  9.277187
5 7.190891 8.338853 8.413892 10.79890 11.53551 8.646506 9.464309 10.649963
6 7.029738 7.757668 9.661314 10.79775 10.76656 9.455848 9.622132  9.286238
      BAG1      BAG3      BAX     BCL2   BCL2A1   BCL2L1      BCR      BID
1 8.247202  8.196225 8.285454 7.061771 6.749110 11.52845 7.478098 8.776066
2 8.696358  8.902348 8.527747 6.923657 6.893357 11.52132 8.600347 8.610633
3 9.137049 10.419071 9.042224 6.782296 6.982602 10.94320 7.660845 8.412206
4 9.052640  9.072504 8.199018 6.960116 6.872465 11.60881 8.420708 7.888162
5 8.499520 10.096657 9.192863 7.054737 6.924474 11.37976 9.646834 9.267554
6 8.357150 10.060701 8.185528 6.969883 6.895864 12.05709 7.877872 8.481050
      BIRC2    BIRC3    BIRC5    BRCA1    BRCA2    CASP3    CASP8     CASP9
1  9.588253 9.120734 8.104391 8.229637 7.606711 8.156865 8.899888 11.856829
2  9.908033 9.838902 7.612666 8.216154 8.249681 7.886652 9.397077 10.377508
3  8.713247 6.861837 7.233072 7.599784 7.478098 8.722548 8.633693  9.513663
4  9.252486 7.334627 8.222438 7.773172 7.825928 7.643726 9.040616 11.105953
5  9.871594 8.805367 6.848384 8.257817 7.295718 8.485559 9.228429 11.620631
6 10.172727 7.896412 7.633207 7.800559 8.152128 7.938922 9.057885  9.975805
      CCL2     CCND1     CCNE1     CCNH     CCT8     CDC40     CDH1      CDK2
1 8.485123 11.237506  7.789426 7.731906 10.66772  9.406706 6.781030  8.861773
2 9.227227  9.940672  8.954642 8.516610 11.26844 10.115095 6.794842  9.412149
3 9.323911 12.750957  8.534080 8.614546 10.77727  9.068780 6.984990 10.132387
4 7.998110 11.441090  8.038295 8.325207 11.28383  8.745830 6.838876  9.477643
5 9.119603 13.649187  9.980143 8.056253 11.00517  9.106713 6.880984  7.992254
6 9.852250 12.280211 10.960413 8.103981 11.21451  9.455284 6.841160  9.530001
      CDK4   CDKN1A   CDKN1B    CDKN2A     CFL1    CFLAR     CFTR    CHEK1
1 10.98201 11.42440 9.383292  7.320087 12.47236 12.02346 6.684829 7.048884
2 10.74663 11.07151 8.996853  8.965756 13.08190 12.51807 6.822915 6.693706
3 11.81952 12.13184 8.620351  7.790862 12.68359 11.99563 6.693981 6.751534
4 10.64447 12.79570 8.049906  7.557507 11.58685 13.04655 6.704771 6.682156
5 10.17820 11.98798 9.213098  6.933126 12.35253 11.90179 6.719023 6.860076
6 10.21128 10.97491 9.271118 10.297463 12.31679 11.90704 6.740824 6.657458
   CIAPIN1     CLDN1    CLDN16    CLDN5     CLDN7      CLU   COX7A2   CTNNB1
1 7.681508  8.708947  7.845268 9.297974  8.338058 7.100871 12.08316 11.56230
2 7.534961  7.926664  7.281107 8.984927  9.550085 6.669287 12.33584 10.68571
3 8.174967 10.655983 11.076369 7.789044  8.605269 7.338735 11.77432 10.93122
4 7.324561  7.969987 10.187592 9.341966 10.588528 7.554864 12.35253 11.40614
5 7.367011  9.324963 10.416467 9.805089  8.059932 7.586933 10.81128 10.55741
6 7.943628 10.406669 12.253335 9.032984  9.119125 6.682610 12.14235 11.60459
    CYP2B6    CYP2E1   CYP3A4   CYP3A5    DAPK1   DIABLO     E2F1    ERBB2
1 7.226860 11.208238 7.734879 6.759182 7.743586 7.424097 7.553361 7.041597
2 7.101800  8.818492 6.606713 7.273960 8.114309 7.736911 9.366599 7.205736
3 6.704883  9.964152 6.633858 6.770068 7.653972 7.709740 7.949149 7.114339
4 6.689213 10.409367 7.027562 7.035601 8.003611 7.678017 7.629158 7.266241
5 6.695742 11.135486 7.115536 6.920464 7.242014 7.347626 8.484248 7.181896
6 6.723709  8.753469 6.602698 6.723458 7.093027 7.551000 9.007671 7.527508
     ERCC1    ERCC2    ERCC3    ERCC5     ERCC8     ETS1       F3     FADD
1 8.119690 6.634948 7.798293 8.375592  9.138738 9.317442 6.497447 8.554351
2 8.512343 8.204595 8.122248 9.597599  9.309278 9.440621 6.744717 8.687447
3 7.454531 7.234607 8.413416 8.782179  9.783796 8.162965 6.800483 9.209239
4 8.102303 7.108459 7.795757 8.744821  9.246290 8.114309 6.658022 8.613511
5 8.014282 6.605423 7.433361 8.567225 10.437541 8.871729 6.836299 9.524010
6 8.224209 7.625147 7.892648 8.870164  9.678867 7.993830 6.712306 8.824009
       FAS    FASLG      FN1       FOS     GART     GJA1     GLO1     GPX2
1 6.661529 6.964673 13.84285 11.834893  9.58040 9.958993 8.524575 6.909208
2 6.940935 7.224190 13.12844  9.774165 10.96740 8.066872 9.729713 6.795481
3 6.856376 6.805081 11.58972 11.241464 10.35577 7.872872 9.562123 6.698990
4 6.769281 6.722381 10.45366  8.293316 11.43317 8.384023 8.875251 6.733681
5 6.778335 7.051708 14.24558 11.396325 10.39101 9.211440 8.911571 6.589032
6 6.959689 7.004315 13.98307 10.381797 10.73191 8.489960 9.608504 6.669961
      GPX4    GSK3B       GSR      GSS    GSTA4    GSTK1     GSTM3     GSTM4
1 6.813452 12.15442  8.398504 8.961541 6.943554 10.32362 10.100971  9.568280
2 7.868558 12.43114 11.220488 7.614796 6.670250 10.43400  8.403353 10.132387
3 7.352592 12.69534  9.704405 7.509262 7.089369 10.72160  9.037159  9.091691
4 7.030146 12.76982  9.733084 8.431504 6.984135 10.82619  8.544503  9.750934
5 7.345952 12.18104  9.412149 8.516610 6.981129 10.28949  9.088984  9.044935
6 7.666169 12.71081 10.075754 8.083219 7.002652 10.01606  9.093766  9.511245
      GSTM5    GSTO1    GSTP1    GSTT1    GSTZ1      HAGH     HIF1A     HSPH1
1 10.306293 8.606291 11.78586 8.416559 7.291539  9.289830  9.491030  9.783796
2  7.872448 9.581561 12.37797 8.778741 7.521389  8.889739 10.110454 10.282395
3  6.983758 7.819526 11.39633 9.023617 7.188044  9.795539 10.382583 10.087814
4  8.406175 8.135362 11.26994 9.001613 7.692207 10.280731  9.825716  9.560779
5 10.084094 9.031920 12.57920 8.777632 7.675928  9.376039  9.642701  9.141591
6  7.612992 8.526893 11.79920 9.071992 7.034782  9.344247 10.097440  9.936790
     IGF1R      IL6     INSR    ITGAE    KCNMA1      KIT     KLF1       LBR
1 6.838876 9.086239 6.800426 7.491948 10.257129 8.975076 6.889729  9.613636
2 6.875127 7.356368 6.702848 7.887034 10.926863 7.326361 6.814125 10.578780
3 7.079108 8.579867 6.759050 8.322547 10.579718 7.096939 6.974354 10.835462
4 6.957563 7.241782 6.629429 8.319912  9.944868 8.286431 6.864716  9.486122
5 6.942007 6.601503 6.822207 6.708006 10.454517 8.897156 6.877372  7.866780
6 7.103209 7.701416 6.772228 7.881255 10.433997 6.945788 6.852500 10.998302
      LIG4   MAP2K1     MAPK3    MAPK8     MCL1     MDM2      MGMT    MKI67
1 7.212709 8.125232 12.160799 6.760280 6.823211 8.373721  8.816099 12.49164
2 7.592506 8.994710 11.779350 6.830487 6.947933 8.272301 11.581831 11.50976
3 7.749951 8.815611 10.489889 6.821279 6.878306 8.728776 10.545614 10.84681
4 8.060331 7.805088 11.525632 6.725328 6.745341 8.798323 10.435745 12.43114
5 7.500034 7.733790 11.825978 6.955973 6.808960 7.974306 11.326666 12.91702
6 8.157733 8.143069  9.615703 6.871519 6.804433 7.806968 11.261863 12.13857
      MLH1     MLH3     MMP2      MMP9    MNAT1   MRE11A     MSH2     MSH3
1 9.572425 9.998742 6.702731 12.978979 7.803568 8.340568 6.980159 8.336425
2 9.386016 7.746810 7.630609 13.738296 7.877496 8.130434 6.932767 8.808049
3 8.983380 8.972458 7.756945  8.245050 8.770694 8.189652 7.287554 9.067189
4 9.197284 9.209753 7.144451  8.381403 9.090058 8.187218 7.071250 8.776066
5 9.587072 9.540095 9.694220 12.311452 8.386363 7.600436 7.044314 7.894203
6 8.377317 8.089658 8.114692 11.661257 8.863229 8.192236 7.272901 8.648388
      MSH6    MUTYH       MVP       MYC    NFKB1   NFKBIA    NR1H3    NR1H4
1 11.48785 8.441406 10.160548 10.863801 7.806222 14.01653 12.28710 6.753944
2 10.43314 8.087351 10.192472 12.136104 8.253187 14.30214 12.88488 6.766869
3 12.30680 8.106060  9.545129  9.928011 8.214850 14.30214 11.06684 6.848135
4 11.06815 8.009482 10.208878 10.804036 7.478761 13.64919 12.25334 6.778560
5 10.48989 8.059121 10.472425 10.493515 7.868558 14.02920 11.92540 6.942543
6 11.07922 7.855445 10.219166 10.781571 7.812260 13.91213 11.68122 6.824061
     NR1I3    NTRK2    PARP2    PDGFRB     PDK1   PIK3CA      POLB     POLI
1 7.164879 6.841160 8.358902  9.370726 6.903371 9.108833 11.120641 7.539652
2 6.812951 7.271305 7.477164  9.034046 7.127309 9.201932  9.964905 8.288179
3 6.798531 8.358488 8.145587 10.246274 7.256301 9.506519 10.098987 8.123014
4 6.888614 7.348783 9.838368  8.617009 6.903549 9.316871  9.659823 8.731196
5 7.389878 6.763306 7.256041  9.977210 6.993913 9.168068 10.835462 8.108127
6 6.742970 7.317526 7.720117  9.911881 7.013408 9.879251 10.386700 7.974730
     PSMA3      RAD1    RAD23A   RAD23B    RAD50    RAD51     RAF1      RB1
1 6.782166 13.030370  9.618876 8.843967 7.413681 7.440083 8.593359 8.702936
2 6.980542 10.503795 10.471470 9.246897 7.798293 6.702731 8.830427 8.617009
3 6.725328  8.564961  8.915122 9.076945 7.891816 6.926470 8.020952 9.674851
4 6.814259 12.015844 10.162910 9.877929 7.947961 7.935052 8.021755 8.412991
5 6.648600 12.268708  9.144911 8.536796 7.971156 8.088937 8.568614 7.822239
6 6.798531  8.672581 10.081694 8.153357 8.079344 6.611246 7.718002 8.936396
      RPL36    SGPP1    SIRT1    SIRT2    SIRT4    SIRT5  SLC10A1  SLC15A2
1 10.354919 6.917069 7.129892 7.144451 6.894916 10.97857 8.833532 7.010702
2 11.276217 7.143976 7.207968 6.662145 7.068340 10.12467 7.207738 7.099184
3 10.143224 7.205455 7.987801 6.566324 6.788607 10.98315 6.965629 7.292587
4  9.923729 6.753404 7.203537 6.982027 6.874808 11.09773 7.741941 7.080201
5 10.808039 7.116433 7.396476 6.953287 6.786749 10.89773 8.283368 7.082766
6 10.983148 6.921313 7.981465 7.454183 7.466898 11.31854 6.951303 7.343303
   SLC16A2  SLC16A3  SLC19A1  SLC19A2   SLC19A3   SLC1A4   SLC1A5  SLC22A1
1 7.935776 7.073882 8.302609 6.608728 10.319222 7.593181 6.722895 6.853897
2 7.306276 7.687788 8.035930 6.973975 11.249055 7.813252 6.843828 6.900822
3 8.088129 7.034543 7.397024 6.673266 10.179876 7.754429 6.794206 6.889729
4 7.656052 6.853179 8.308380 6.664070  8.808519 7.536985 6.837693 6.776230
5 7.268498 7.590332 9.109394 6.946268 12.026946 7.789426 6.767923 6.881709
6 7.061949 7.471210 8.479222 6.851816 10.216842 7.261172 6.847398 6.992752
   SLC28A1   SLC29A1   SLC29A2    SLC2A5  SLC31A1    SLC7A1  SLC7A10  SLC7A11
1 6.674104 10.014521  9.864982  9.048300 7.571797  8.920121 6.829303 7.247272
2 6.662544  9.981688 10.072713  9.798107 8.382291  9.969333 6.999004 6.633858
3 6.592974  9.491030  9.182233  7.686160 8.104815  9.705134 7.536985 7.488330
4 6.483127  9.713148  9.538248  7.253627 8.433297  8.508646 7.093263 7.495513
5 6.723320  9.668169  9.159178 10.168625 7.899521  9.433523 6.904507 6.656101
6 6.672712  9.431107  9.219328  8.476463 8.217021 10.246274 9.037159 7.903030
    SLC7A2    SLC7A5   SLC7A8 SLC9A3R2  SLCO4A1      SP1      SRC    STAT1
1 7.079565  9.537659 9.178516 9.574976 6.934997 8.724469 11.78092 14.12329
2 7.195008 11.765885 8.660329 8.738353 9.133377 8.947775 11.09672 13.52122
3 7.195264 10.746632 8.184732 8.696358 8.134120 9.789807 10.89362 12.96082
4 7.653623 11.041209 8.868709 9.726282 7.297339 8.790778 11.42155 13.23216
5 7.182167 10.971551 9.391325 8.800765 9.034046 7.951562 11.24649 13.50068
6 6.940789 10.242153 7.481978 9.236139 7.334928 8.708947 11.30645 13.22267
     STAT3   STAT5A   STAT5B     TGFA    TIMP1   TMEM109  TNFSF10     TOP1
1 10.38670 7.598387 7.370609 8.495975 12.94263  9.197852 7.350274 11.14493
2 11.44832 8.313083 8.451724 8.204998 13.42744  9.917066 7.985511 11.41880
3 10.81887 7.558533 8.701540 8.289002 14.44965 10.019861 6.702332 10.86906
4 10.79106 7.047179 7.844877 8.158572 13.50068  9.005625 6.777934 11.42440
5 10.72573 7.079323 7.921993 8.539952 14.22980  9.499840 7.336431 10.64622
6 11.00185 7.527831 8.021755 8.726781 13.11178  8.997311 8.475478 11.28510
      TOP2A     TOP2B      TP53   TP53BP2     TP73     TRADD    TRAF1      XPA
1  8.878214 10.313158  8.253187 10.893620 6.604516 10.627634 6.891011 6.557723
2 11.318544 10.403172  8.157733 10.405792 6.713857 11.563815 7.017953 6.634579
3 10.001815  9.987692  7.967948 10.090610 7.120558  9.583350 6.979454 6.644534
4 10.606993 10.428813 10.618854 10.079322 7.011689  9.879251 7.062134 6.713586
5 10.291002  9.870044  7.643020  9.946294 6.582531 11.636604 6.971541 6.680946
6 10.660817 10.509485  9.061171 11.044895 6.722895 10.745602 7.272121 6.692519
       XPC    XRCC1    XRCC2    XRCC3    XRCC4    XRCC5
1 11.46091 8.462342 6.820206 7.406896 6.749753 13.09007
2 10.57020 9.047179 7.347931 8.022978 7.009499 12.53423
3 10.79775 7.874741 7.123481 7.499060 6.685486 14.11107
4 11.44710 8.113415 6.991716 8.012213 6.775875 13.57871
5 11.33618 8.468848 6.863026 7.687788 6.880655 12.97898
6 10.24550 8.257817 7.140145 7.470006 6.844277 13.44681</code></pre>
</div>
</div>
</section>
<section id="contingency-tables-ct" class="slide level2">
<h2>Contingency tables (CT)</h2>
<p>CTs are tables that summarize 2 or more categorical variables using absolute or relative frequencies.</p>

<img data-src="img/contingency-table.svg" class="r-stretch quarto-figure-center"></section>
<section id="contingency-tables-ct-1" class="slide level2">
<h2>Contingency tables (CT)</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table data-quarto-postprocess="true" style="border-collapse:collapse; border:none;">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<tbody>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: italic; font-weight: normal; border-bottom: 1px solid;">x</td>
<td colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: italic; font-weight: normal;">y</td>
<td rowspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: italic; font-weight: normal; font-weight: bolder; font-style: italic; border-bottom: 1px solid;">Total</td>
</tr>
<tr class="even">
<td style="text-align: center; border-bottom: 1px solid; padding: 0.2cm;">1</td>
<td style="text-align: center; border-bottom: 1px solid; padding: 0.2cm;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: middle;">1</td>
<td style="text-align: center; padding: 0.2cm;"><span style="color:black;">32</span><br>
<span style="color:#993333;">21.3&nbsp;%</span></td>
<td style="text-align: center; padding: 0.2cm;"><span style="color:black;">40</span><br>
<span style="color:#993333;">26.7&nbsp;%</span></td>
<td style="text-align: center; padding: 0.2cm;"><span style="color:black;">72</span><br>
<span style="color:#993333;">48&nbsp;%</span></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: middle;">0</td>
<td style="text-align: center; padding: 0.2cm;"><span style="color:black;">47</span><br>
<span style="color:#993333;">31.3&nbsp;%</span></td>
<td style="text-align: center; padding: 0.2cm;"><span style="color:black;">31</span><br>
<span style="color:#993333;">20.7&nbsp;%</span></td>
<td style="text-align: center; padding: 0.2cm;"><span style="color:black;">78</span><br>
<span style="color:#993333;">52&nbsp;%</span></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; border-bottom: double; font-weight: bolder; font-style: italic; vertical-align: middle;">Total</td>
<td style="text-align: center; padding: 0.2cm; border-bottom: double;"><span style="color:black;">79</span><br>
<span style="color:#993333;">52.7&nbsp;%</span></td>
<td style="text-align: center; padding: 0.2cm; border-bottom: double;"><span style="color:black;">71</span><br>
<span style="color:#993333;">47.3&nbsp;%</span></td>
<td style="text-align: center; padding: 0.2cm; border-bottom: double;"><span style="color:black;">150</span><br>
<span style="color:#993333;">100&nbsp;%</span></td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="contingency-tables-ct-2" class="slide level2">
<h2>Contingency tables (CT)</h2>
<p>Regardless of the content, contingency tables can be expressed with a common nomenclature.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="table" data-quarto-postprocess="true" style="margin-left: auto; margin-right: auto;">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; empty-cells: hide; border-bottom: hidden;"></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Truth
</div></th>
</tr>
<tr class="odd">
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; empty-cells: hide; border-bottom: hidden;"></th>
<th data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
1
</div></th>
<th data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
0
</div></th>
</tr>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="2" style="text-align: center; font-weight: bold; vertical-align: middle !important;">Prediction</td>
<td style="text-align: center; font-weight: bold;">1</td>
<td style="text-align: center;"><span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightgreen !important;">True Positive (TP)</span></td>
<td style="text-align: center;"><span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: #FC8D8D !important;">False Positive (FP)</span></td>
</tr>
<tr class="even">
<td style="text-align: center; font-weight: bold;">0</td>
<td style="text-align: center;"><span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: #FC8D8D !important;">False Negative (FN)</span></td>
<td style="text-align: center;"><span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightgreen !important;">True Negative (TN)</span></td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="contingency-tables-ct-3" class="slide level2">
<h2>Contingency tables (CT)</h2>
<p>There are a lot of metrics that can be calculated from a simple contingency tables:</p>
<div class="cell" data-layout-align="center">
<iframe src="https://en.wikipedia.org/wiki/Confusion_matrix" width="960" height="400px" data-external="1">
</iframe>
</div>
</section>
<section id="contingency-tables-ct-metrics" class="slide level2">
<h2>Contingency tables (CT) metrics</h2>
<p>The most important (and used) measures are:</p>
<ul>
<li>the <strong>Sensitivity</strong> (aka <strong>True Positive Rate</strong> TPR or <em>recall</em>) is <span class="math inline">\(\frac{TP}{(TP + FN)}\)</span></li>
<li>the <strong>Specificity</strong> (aka <strong>True Negative Rate</strong> TNR) is <span class="math inline">\(\frac{TN}{(FP + TN)}\)</span></li>
<li>the <strong>Accuracy</strong> is <span class="math inline">\(\frac{(TP + TN)}{(TP + TN + FP + FN)}\)</span></li>
<li>the <strong>Positive Predictive Value</strong> is <span class="math inline">\(\frac{TP}{TP + FP}\)</span> or <span class="math inline">\(\frac{TPR \times \rho}{TPR \times \rho + (1 - TPR) \times (1 - \rho)}\)</span> where <span class="math inline">\(\rho\)</span> is the prevalence i.e.&nbsp;<span class="math inline">\(TP + FP\)</span></li>
<li>Area Under the Curve (AUC) is the area under the ROC curve that represent classification performance</li>
</ul>
</section>
<section id="contingency-tables-ct-metrics-1" class="slide level2">
<h2>Contingency tables (CT) metrics</h2>
<div class="cell" data-layout-align="center">

<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="2">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Truth
</div>
</th>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="1">
</th>
</tr>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="2">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
1
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
0
</div>
</th>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="1">
</th>
</tr>
<tr>
<th style="text-align:center;">
</th>
<th style="text-align:center;">
</th>
<th style="text-align:center;">
</th>
<th style="text-align:center;">
</th>
<th style="text-align:center;">
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;font-weight: bold;vertical-align: middle !important;" rowspan="2">
Test
</td>
<td style="text-align:center;font-weight: bold;">
1
</td>
<td style="text-align:center;">
<span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightgreen !important;">True Positive (TP)</span>
</td>
<td style="text-align:center;">
<span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: #FC8D8D !important;">False Positive (FP)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(PPV = \frac{TP}{TP + FP}\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;font-weight: bold;">
0
</td>
<td style="text-align:center;">
<span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: #FC8D8D !important;">False Negative (FN)</span>
</td>
<td style="text-align:center;">
<span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightgreen !important;">True Negative (TN)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(NPV = \frac{TN}{TN + FN}\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;font-weight: bold;vertical-align: middle !important;" rowspan="2">
</td>
<td style="text-align:center;font-weight: bold;">
</td>
<td style="text-align:center;">
<span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: white !important;"><span class="math inline">\(Sensitivity = \frac{TP}{TP + FN}\)</span></span>
</td>
<td style="text-align:center;">
<span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: white !important;"><span class="math inline">\(Specificity = \frac{TN}{TN + FP}\)</span></span>
</td>
<td style="text-align:center;vertical-align: middle !important;" rowspan="2">
<span class="math inline">\(N = TP + FP + FN + TN\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;font-weight: bold;">
</td>
<td style="text-align:center;">
<span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: white !important;"><span class="math inline">\(\rho = \frac{TP + FN}{N}\)</span></span>
</td>
<td style="text-align:center;">
<span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: white !important;"><span class="math inline">\(1 - \rho = \frac{FP + TN}{N}\)</span></span>
</td>
</tr>
</tbody>

</table>
</div>
</section>
<section id="contingency-tables-ct-metrics-2" class="slide level2">
<h2>Contingency tables (CT) metrics</h2>
<div class="cell" data-layout-align="center">

<table class="table" style="font-size: 23px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="2">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Truth
</div>
</th>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="1">
</th>
</tr>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="2">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
1
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
0
</div>
</th>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="1">
</th>
</tr>
<tr>
<th style="text-align:center;">
</th>
<th style="text-align:center;">
</th>
<th style="text-align:center;">
</th>
<th style="text-align:center;">
</th>
<th style="text-align:center;">
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;font-weight: bold;vertical-align: middle !important;" rowspan="2">
Test
</td>
<td style="text-align:center;font-weight: bold;">
1
</td>
<td style="text-align:center;">
<span class="math inline">\(Sensitivity \times \rho\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\((1 - Specificity) \times (1 - \rho)\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(PPV = \frac{Sensitivity \times \rho}{Sensitivity \times \rho + (1 - Sensitivity) \times (1 - \rho)}\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;font-weight: bold;">
0
</td>
<td style="text-align:center;">
<span class="math inline">\((1 - Sensitivity) \times \rho\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(Specificity \times (1 - \rho)\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(NPV = \frac{Specificity \times (1 - \rho)}{(1 - Sensitivity) \times \rho + Specificity \times (1 - \rho)}\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;font-weight: bold;vertical-align: middle !important;" rowspan="2">
</td>
<td style="text-align:center;font-weight: bold;">
</td>
<td style="text-align:center;">
<span class="math inline">\(Sensitivity = \frac{TP}{TP + FN}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(Specificity = \frac{TN}{TN + FP}\)</span>
</td>
<td style="text-align:center;vertical-align: middle !important;" rowspan="2">
1
</td>
</tr>
<tr>
<td style="text-align:center;font-weight: bold;">
</td>
<td style="text-align:center;">
<span class="math inline">\(\rho\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(1 - \rho\)</span>
</td>
</tr>
</tbody>

</table>
</div>
</section>
<section id="sensitivity-and-specificity" class="slide level2">
<h2>Sensitivity and Specificity</h2>
<p>To better understand the <em>sensitivity</em> and <em>specificity</em> we can use several formulations. <em>Sensitivity</em> and <em>Specificity</em> (and also other metrics) are essentially conditional probabilities.</p>
<p><span class="math display">\[
Sensitivity = p(T^+|S^+) = \frac{p(S^+|T^+)p(T^+)}{p(S^+)} = \frac{\frac{TP}{TP + FP}\frac{TP + FP}{N}}{\frac{TP + FN}{N}} = \frac{PPVp(T^+)}{\rho}
\]</span></p>
<p><span class="math display">\[
Specificity = p(T^-|S^-) = \frac{p(S^-|T^-)p(T^-)}{p(S^-)} = \frac{\frac{TN}{TN + FN}\frac{TN + FN}{N}}{\frac{FP + TN}{N}} = \frac{NPVp(T^-)}{1 -\rho}
\]</span></p>
</section>
<section id="positive-predictive-value-ppv" class="slide level2">
<h2>Positive Predictive Value (PPV)</h2>
<p>The PPV is the probability of having a diseases given that my test is positive. While sensitivity and specificity are generally stable regardless the prevalence <span class="citation" data-cites="Brenner1997-yq">(but see <a href="#/references-download-.bib-file" role="doc-biblioref" onclick="">Brenner &amp; Gefeller, 1997</a>)</span>, PPV is strongly affected by the disease prevalence.</p>
<p>Let’s write a function to calculate the PPV:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>ppv <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">tp =</span> <span class="cn">NULL</span>,</span>
<span id="cb13-2"><a href="#cb13-2"></a>                <span class="at">fp =</span> <span class="cn">NULL</span>, </span>
<span id="cb13-3"><a href="#cb13-3"></a>                <span class="at">sensitivity =</span> <span class="cn">NULL</span>, </span>
<span id="cb13-4"><a href="#cb13-4"></a>                <span class="at">specificity =</span> <span class="cn">NULL</span>, </span>
<span id="cb13-5"><a href="#cb13-5"></a>                <span class="at">prevalence =</span> <span class="cn">NULL</span>){</span>
<span id="cb13-6"><a href="#cb13-6"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(tp) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.null</span>(fp)){</span>
<span id="cb13-7"><a href="#cb13-7"></a>    tp <span class="sc">/</span> (tp <span class="sc">+</span> fp)</span>
<span id="cb13-8"><a href="#cb13-8"></a>  } <span class="cf">else</span> <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(sensitivity) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.null</span>(specificity) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.null</span>(prevalence)){</span>
<span id="cb13-9"><a href="#cb13-9"></a>    (sensitivity <span class="sc">*</span> prevalence) <span class="sc">/</span> (sensitivity <span class="sc">*</span> prevalence <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> specificity) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> prevalence))</span>
<span id="cb13-10"><a href="#cb13-10"></a>  } <span class="cf">else</span>{</span>
<span id="cb13-11"><a href="#cb13-11"></a>    <span class="fu">stop</span>(<span class="st">"To calculate PPV tp AND fp OR sensitivity AND specificity AND prevalence need to be specified!"</span>)</span>
<span id="cb13-12"><a href="#cb13-12"></a>  }</span>
<span id="cb13-13"><a href="#cb13-13"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="positive-predictive-value-ppv-1" class="slide level2">
<h2>Positive Predictive Value (PPV)</h2>
<p>Now we can calculate the PPV, fixing <em>sensitivity</em> and <em>specificity</em> by changing the <strong>prevalence</strong>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="co"># let's vary the prevalence</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>prevalence <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.01</span>)</span>
<span id="cb14-3"><a href="#cb14-3"></a></span>
<span id="cb14-4"><a href="#cb14-4"></a><span class="co"># computing ppv for each prevalence, fixing the specificity and sensitivity</span></span>
<span id="cb14-5"><a href="#cb14-5"></a>ppvs <span class="ot">&lt;-</span> <span class="fu">ppv</span>(<span class="at">sensitivity =</span> <span class="fl">0.9</span>, <span class="at">specificity =</span> <span class="fl">0.8</span>, <span class="at">prevalence =</span> prevalence)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

<img data-src="03-biostatistics_files/figure-revealjs/unnamed-chunk-22-1.svg" width="960" class="r-stretch quarto-figure-center"></section>
<section id="youdens-j-disclaimer" class="slide level2">
<h2>Youden’s J, disclaimer</h2>
<p>The Youden’s J is just an option among several alternatives for choosing the best threshold. For example the <code>cutpointr</code> package:</p>
<div class="cell" data-layout-align="center">
<iframe src="https://cran.r-project.org/web/packages/cutpointr/vignettes/cutpointr.html#:~:text=in%20both%20classes-,Metric%20functions,-The%20included%20metrics" width="960" height="400px" data-external="1">
</iframe>
</div>
</section>
<section id="an-example" class="slide level2">
<h2>An example…</h2>
<p>Let’s imagine to have a group of patients with a certain disease (called <span class="math inline">\(S\)</span>) or condition measured by a <strong>gold-standard</strong> test. We are developing a new faster and cheaper test (called <span class="math inline">\(T\)</span>) but we are not sure about the capacity to reliably detect the condition.</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Simulation code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>dat_ex <span class="ot">&lt;-</span> <span class="fu">sim_bin_class</span>(<span class="fl">0.75</span>, <span class="at">n =</span> <span class="dv">100</span>, <span class="at">prevalence =</span> <span class="fl">0.2</span>, <span class="at">var.names =</span> <span class="fu">c</span>(<span class="at">x =</span> <span class="st">"test"</span>, <span class="at">y =</span> <span class="st">"state"</span>))</span>
<span id="cb15-2"><a href="#cb15-2"></a>dat_ex<span class="sc">$</span>state <span class="ot">&lt;-</span> <span class="fu">factor</span>(dat_ex<span class="sc">$</span>state, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"sick"</span>, <span class="st">"healthy"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>    state   test
1 healthy  0.091
2 healthy  0.566
3 healthy -1.642
4 healthy -0.841
5     ...    ...
6    sick  1.503
7    sick   0.78
8    sick -0.445
9    sick  0.829</code></pre>
</div>
</div>
</section>
<section id="binary-classifiers" class="slide level2">
<h2>Binary classifiers</h2>
<div class="panel-tabset">
<ul id="tabset-1" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-1-1">Summary</a></li><li><a href="#tabset-1-2">Dotplot</a></li><li><a href="#tabset-1-3">Density Plot</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="co"># total</span></span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="fu">nrow</span>(dat_ex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 100</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="co"># prevalence</span></span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="fu">table</span>(dat_ex<span class="sc">$</span>state)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   sick healthy 
     20      80 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="fu">table</span>(dat_ex<span class="sc">$</span>state) <span class="sc">/</span> <span class="fu">nrow</span>(dat_ex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   sick healthy 
    0.2     0.8 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="co"># difference in the test between the two groups</span></span>
<span id="cb23-2"><a href="#cb23-2"></a><span class="fu">tapply</span>(dat_ex<span class="sc">$</span>test, dat_ex<span class="sc">$</span>state, mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      sick    healthy 
 0.8804449 -0.6920013 </code></pre>
</div>
</div>
</div>
<div id="tabset-1-2">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="03-biostatistics_files/figure-revealjs/unnamed-chunk-27-1.svg" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-3">
<p>Probably the most intuitive way is the density plot for each group:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="03-biostatistics_files/figure-revealjs/unnamed-chunk-28-1.svg" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="binary-classifiers-1" class="slide level2">
<h2>Binary classifiers</h2>
<p>Intuitively, as the mean difference (on the predictor) between the two groups increase the two groups are easy to discriminate:</p>

<img data-src="03-biostatistics_files/figure-revealjs/unnamed-chunk-29-1.svg" width="960" class="r-stretch quarto-figure-center"></section>
<section id="binary-classifiers-thresholds" class="slide level2">
<h2>Binary classifiers, Thresholds</h2>
<p>To create a contingency table and calculate the related metrics we need to choose a threshold on the predictor variable:</p>
<div class="panel-tabset">
<ul id="tabset-2" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-2-1">Threshold = 0</a></li><li><a href="#tabset-2-2">Threshold = -1.5</a></li><li><a href="#tabset-2-3">Threshold = 2</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="03-biostatistics_files/figure-revealjs/unnamed-chunk-31-1.svg" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-2">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="03-biostatistics_files/figure-revealjs/unnamed-chunk-32-1.svg" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-3">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="03-biostatistics_files/figure-revealjs/unnamed-chunk-33-1.svg" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="binary-classifiers-thresholds-1" class="slide level2">
<h2>Binary classifiers, Thresholds</h2>
<p>Similarly, we can create the contingency tables with related metrics:</p>
<div class="panel-tabset">
<ul id="tabset-3" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-3-1">Threshold = 0</a></li><li><a href="#tabset-3-2">Threshold = -1.5</a></li><li><a href="#tabset-3-3">Threshold = 2</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="table" data-quarto-postprocess="true" style="font-size: 20px; margin-left: auto; margin-right: auto;border-bottom: 0;">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; empty-cells: hide; border-bottom: hidden;"></th>
<th colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Truth
</div></th>
</tr>
<tr class="odd">
<th style="text-align: center;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">1</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">0</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Tot</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="3" style="text-align: center; font-weight: bold; vertical-align: middle !important;">Test</td>
<td style="text-align: center; font-weight: bold;">1</td>
<td style="text-align: center;"><span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightgreen !important;">4099</span></td>
<td style="text-align: center;"><span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: #FC8D8D !important;">935</span></td>
<td style="text-align: center;">5034</td>
</tr>
<tr class="even">
<td style="text-align: center; font-weight: bold;">0</td>
<td style="text-align: center;"><span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: #FC8D8D !important;">901</span></td>
<td style="text-align: center;"><span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightgreen !important;">4065</span></td>
<td style="text-align: center;">4966</td>
</tr>
<tr class="odd">
<td style="text-align: center; font-weight: bold;">Tot</td>
<td style="text-align: center;"><span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: white !important;">5000</span></td>
<td style="text-align: center;"><span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: white !important;">5000</span></td>
<td style="text-align: center;">10000</td>
</tr>
</tbody><tfoot>
<tr class="odd">
<td style="text-align: center; padding: 0;"><sup></sup> <strong>Threshold</strong> = 0</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center; padding: 0;"><sup></sup> <strong>Sensitivity</strong> = 0.820</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center; padding: 0;"><sup></sup> <strong>Specificity</strong> = 0.813</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center; padding: 0;"><sup></sup> <strong>PPV</strong> = 0.814</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tfoot>

</table>


</div>
</div>
</div>
<div id="tabset-3-2">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="table" data-quarto-postprocess="true" style="font-size: 20px; margin-left: auto; margin-right: auto;border-bottom: 0;">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; empty-cells: hide; border-bottom: hidden;"></th>
<th colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Truth
</div></th>
</tr>
<tr class="odd">
<th style="text-align: center;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">1</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">0</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Tot</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="3" style="text-align: center; font-weight: bold; vertical-align: middle !important;">Test</td>
<td style="text-align: center; font-weight: bold;">1</td>
<td style="text-align: center;"><span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightgreen !important;">4963</span></td>
<td style="text-align: center;"><span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: #FC8D8D !important;">3637</span></td>
<td style="text-align: center;">8600</td>
</tr>
<tr class="even">
<td style="text-align: center; font-weight: bold;">0</td>
<td style="text-align: center;"><span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: #FC8D8D !important;">37</span></td>
<td style="text-align: center;"><span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightgreen !important;">1363</span></td>
<td style="text-align: center;">1400</td>
</tr>
<tr class="odd">
<td style="text-align: center; font-weight: bold;">Tot</td>
<td style="text-align: center;"><span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: white !important;">5000</span></td>
<td style="text-align: center;"><span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: white !important;">5000</span></td>
<td style="text-align: center;">10000</td>
</tr>
</tbody><tfoot>
<tr class="odd">
<td style="text-align: center; padding: 0;"><sup></sup> <strong>Threshold</strong> = -1.5</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center; padding: 0;"><sup></sup> <strong>Sensitivity</strong> = 0.993</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center; padding: 0;"><sup></sup> <strong>Specificity</strong> = 0.273</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center; padding: 0;"><sup></sup> <strong>PPV</strong> = 0.577</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tfoot>

</table>


</div>
</div>
</div>
<div id="tabset-3-3">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="table" data-quarto-postprocess="true" style="font-size: 20px; margin-left: auto; margin-right: auto;border-bottom: 0;">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; empty-cells: hide; border-bottom: hidden;"></th>
<th colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Truth
</div></th>
</tr>
<tr class="odd">
<th style="text-align: center;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">1</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">0</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Tot</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="3" style="text-align: center; font-weight: bold; vertical-align: middle !important;">Test</td>
<td style="text-align: center; font-weight: bold;">1</td>
<td style="text-align: center;"><span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightgreen !important;">665</span></td>
<td style="text-align: center;"><span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: #FC8D8D !important;">9</span></td>
<td style="text-align: center;">674</td>
</tr>
<tr class="even">
<td style="text-align: center; font-weight: bold;">0</td>
<td style="text-align: center;"><span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: #FC8D8D !important;">4335</span></td>
<td style="text-align: center;"><span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightgreen !important;">4991</span></td>
<td style="text-align: center;">9326</td>
</tr>
<tr class="odd">
<td style="text-align: center; font-weight: bold;">Tot</td>
<td style="text-align: center;"><span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: white !important;">5000</span></td>
<td style="text-align: center;"><span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: white !important;">5000</span></td>
<td style="text-align: center;">10000</td>
</tr>
</tbody><tfoot>
<tr class="odd">
<td style="text-align: center; padding: 0;"><sup></sup> <strong>Threshold</strong> = 2</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center; padding: 0;"><sup></sup> <strong>Sensitivity</strong> = 0.133</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center; padding: 0;"><sup></sup> <strong>Specificity</strong> = 0.998</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center; padding: 0;"><sup></sup> <strong>PPV</strong> = 0.987</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tfoot>

</table>


</div>
</div>
</div>
</div>
</div>
</section>
<section id="roc" class="slide level2">
<h2>ROC</h2>
<p>We can start by plotting the specificity and sensitivity for a given threshold:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>cmat <span class="ot">&lt;-</span> <span class="fu">classify</span>(dat_ex_90, state, test, <span class="at">c =</span> <span class="dv">0</span>)</span>
<span id="cb25-2"><a href="#cb25-2"></a>cmat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    tp  fp   tn  fn    tpr   fpr   tnr    fnr   tot prevalence c      ppv
1 4099 935 4065 901 0.8198 0.187 0.813 0.1802 10000        0.5 0 0.814263
        npv
1 0.8185663</code></pre>
</div>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="03-biostatistics_files/figure-revealjs/unnamed-chunk-39-1.svg" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="roc-1" class="slide level2">
<h2>ROC</h2>
<p>When evaluating <strong>sensitivity</strong> and <strong>specificity</strong> with multiple thresholds we obtain the ROC curve:</p>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/roc-anim.gif" style="width:50.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="roc-2" class="slide level2">
<h2>ROC</h2>
<p>The Area Under the Curve (AUC) range between 0.5 (null classification) and 1 (perfect classification):</p>

<img data-src="03-biostatistics_files/figure-revealjs/unnamed-chunk-41-1.svg" width="960" class="r-stretch quarto-figure-center"></section>
<section id="youdens-j" class="slide level2">
<h2>Youden’s J</h2>
<p>Given the trade-off between sensitivity and specificity, the choice of the best threshold (<span class="math inline">\(c\)</span>) is not straightforward. An option is using the Youden’s J:</p>
<p><span class="math display">\[
J = sensitivity + specificity - 1
\]</span> Thus taking the maximum of <span class="math inline">\(J_i\)</span> calculated on all threshold give us the threshold that maximize the sum between sensitivity and specificity.</p>
</section>
<section id="youdens-j-1" class="slide level2">
<h2>Youden’s J</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="fu">set.seed</span>(<span class="dv">104</span>)</span>
<span id="cb27-2"><a href="#cb27-2"></a>dat <span class="ot">&lt;-</span> <span class="fu">sim_bin_class</span>(<span class="at">auc =</span> <span class="fl">0.8</span>, <span class="at">n =</span> <span class="dv">100</span>, <span class="at">prevalence =</span> <span class="fl">0.5</span>)</span>
<span id="cb27-3"><a href="#cb27-3"></a>fit_roc <span class="ot">&lt;-</span> <span class="fu">roc</span>(y <span class="sc">~</span> x, <span class="at">data =</span> dat)</span>
<span id="cb27-4"><a href="#cb27-4"></a>J <span class="ot">&lt;-</span> <span class="fu">coords</span>(fit_roc, <span class="st">"best"</span>, <span class="at">best.method =</span> <span class="st">"youden"</span>)</span>
<span id="cb27-5"><a href="#cb27-5"></a>J<span class="sc">$</span>J <span class="ot">&lt;-</span> J<span class="sc">$</span>specificity <span class="sc">+</span> J<span class="sc">$</span>sensitivity <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb27-6"><a href="#cb27-6"></a>Js <span class="ot">&lt;-</span> fit_roc<span class="sc">$</span>sensitivities <span class="sc">+</span> fit_roc<span class="sc">$</span>specificities <span class="sc">-</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb28-2"><a href="#cb28-2"></a><span class="fu">plot</span>(fit_roc, <span class="at">main =</span> <span class="st">"ROC curve"</span>)</span>
<span id="cb28-3"><a href="#cb28-3"></a><span class="fu">points</span>(<span class="at">x =</span> J<span class="sc">$</span>specificity, <span class="at">y =</span> J<span class="sc">$</span>sensitivity, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"firebrick"</span>, <span class="at">cex =</span> <span class="fl">1.4</span>)</span>
<span id="cb28-4"><a href="#cb28-4"></a></span>
<span id="cb28-5"><a href="#cb28-5"></a><span class="fu">plot</span>(fit_roc<span class="sc">$</span>thresholds, Js, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">xlab =</span> <span class="st">"Thresholds"</span>, <span class="at">ylab =</span> <span class="st">"Youden's J"</span>,</span>
<span id="cb28-6"><a href="#cb28-6"></a>     <span class="at">main =</span> <span class="st">"Youden's J"</span>)</span>
<span id="cb28-7"><a href="#cb28-7"></a><span class="fu">points</span>(J<span class="sc">$</span>threshold, <span class="fu">max</span>(Js), <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"firebrick"</span>, <span class="at">cex =</span> <span class="fl">1.4</span>)</span>
<span id="cb28-8"><a href="#cb28-8"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fl">0.6</span>, <span class="at">y =</span> <span class="fl">0.45</span>, <span class="at">labels =</span> <span class="fu">sprintf</span>(<span class="st">"Cutoff = %.2f"</span>, J<span class="sc">$</span>threshold))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="03-biostatistics_files/figure-revealjs/unnamed-chunk-43-1.svg" width="960" class="r-stretch quarto-figure-center"></section>
<section id="data-simulation" class="slide level2 extra">
<h2>Data simulation</h2>
<p>All the example so far are based on simulated data. I wrote a little function (<code>sim_bin_class()</code>) that simulate a binary classifier assuming a latent probit model. You can play around to check what happens changing the parameters.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>sim_bin_class <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">auc =</span> <span class="cn">NULL</span>,</span>
<span id="cb29-2"><a href="#cb29-2"></a>                          <span class="at">d =</span> <span class="cn">NULL</span>,</span>
<span id="cb29-3"><a href="#cb29-3"></a>                          n, </span>
<span id="cb29-4"><a href="#cb29-4"></a>                          prevalence, </span>
<span id="cb29-5"><a href="#cb29-5"></a>                          <span class="at">x.mean =</span> <span class="dv">0</span>,</span>
<span id="cb29-6"><a href="#cb29-6"></a>                          <span class="at">x.sd =</span> <span class="dv">1</span>,</span>
<span id="cb29-7"><a href="#cb29-7"></a>                          <span class="at">var.names =</span> <span class="fu">c</span>(<span class="at">x =</span> <span class="st">"x"</span>, <span class="at">y =</span> <span class="st">"y"</span>)){</span>
<span id="cb29-8"><a href="#cb29-8"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(auc) <span class="sc">&amp;</span> <span class="fu">is.null</span>(d)){</span>
<span id="cb29-9"><a href="#cb29-9"></a>    <span class="fu">stop</span>(<span class="st">"AUC or d need to be specified"</span>)</span>
<span id="cb29-10"><a href="#cb29-10"></a>  }</span>
<span id="cb29-11"><a href="#cb29-11"></a>  </span>
<span id="cb29-12"><a href="#cb29-12"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(d)){</span>
<span id="cb29-13"><a href="#cb29-13"></a>    d <span class="ot">&lt;-</span> <span class="fu">auc_to_d</span>(auc)</span>
<span id="cb29-14"><a href="#cb29-14"></a>  }</span>
<span id="cb29-15"><a href="#cb29-15"></a>  </span>
<span id="cb29-16"><a href="#cb29-16"></a>  n1 <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(n <span class="sc">*</span> prevalence)</span>
<span id="cb29-17"><a href="#cb29-17"></a>  n0 <span class="ot">&lt;-</span> n <span class="sc">-</span> n1</span>
<span id="cb29-18"><a href="#cb29-18"></a>  y <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="fu">c</span>(n0, n1))</span>
<span id="cb29-19"><a href="#cb29-19"></a>  x <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(y <span class="sc">==</span> <span class="dv">1</span>, <span class="fu">rnorm</span>(n1, (d<span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span>x.sd <span class="sc">+</span> x.mean, <span class="dv">1</span>), <span class="fu">rnorm</span>(n0, (<span class="sc">-</span>d<span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span>x.sd <span class="sc">+</span> x.mean, <span class="dv">1</span>))</span>
<span id="cb29-20"><a href="#cb29-20"></a>  dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(y, x)</span>
<span id="cb29-21"><a href="#cb29-21"></a>  <span class="fu">names</span>(dat) <span class="ot">&lt;-</span> var.names[<span class="fu">names</span>(dat)]</span>
<span id="cb29-22"><a href="#cb29-22"></a>  <span class="fu">return</span>(dat)</span>
<span id="cb29-23"><a href="#cb29-23"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-simulation-1" class="slide level2 extra">
<h2>Data simulation</h2>
<p>Let’s make an example simulating a binary classifier with an AUC of 0.7:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">sim_bin_class</span>(<span class="at">auc =</span> <span class="fl">0.7</span>, <span class="at">n =</span> <span class="dv">100</span>, <span class="at">prevalence =</span> <span class="fl">0.5</span>)</span>
<span id="cb30-2"><a href="#cb30-2"></a><span class="fu">head</span>(dat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  y          x
1 0  0.8100790
2 0 -0.4872855
3 0  0.2173173
4 0 -1.3149524
5 0 -0.5828904
6 0 -1.1558787</code></pre>
</div>
</div>
</section>
<section id="data-simulation-2" class="slide level2 extra">
<h2>Data simulation</h2>
<p>Let’s see some useful descriptive plots:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="fu">plot_class</span>(dat, y, x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="03-biostatistics_files/figure-revealjs/unnamed-chunk-46-1.svg" width="960" class="r-stretch quarto-figure-center"></section>
<section id="data-simulation-3" class="slide level2 extra">
<h2>Data simulation</h2>
<p>The <code>plot_class()</code> function is a shortcut to produce the dotplot-density combination that is useful when plotting a binary classifier:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>plot_class <span class="ot">&lt;-</span> <span class="cf">function</span>(data, y, x){</span>
<span id="cb33-2"><a href="#cb33-2"></a>  </span>
<span id="cb33-3"><a href="#cb33-3"></a>  x <span class="ot">&lt;-</span> <span class="fu">deparse</span>(<span class="fu">substitute</span>(x))</span>
<span id="cb33-4"><a href="#cb33-4"></a>  y <span class="ot">&lt;-</span> <span class="fu">deparse</span>(<span class="fu">substitute</span>(y))</span>
<span id="cb33-5"><a href="#cb33-5"></a>  </span>
<span id="cb33-6"><a href="#cb33-6"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.numeric</span>(data[[y]])) <span class="fu">stop</span>(<span class="st">"The response variable need to be numeric (0-1)"</span>)</span>
<span id="cb33-7"><a href="#cb33-7"></a></span>
<span id="cb33-8"><a href="#cb33-8"></a>  dens <span class="ot">&lt;-</span> <span class="fu">tapply</span>(data[[x]], data[[y]], density)</span>
<span id="cb33-9"><a href="#cb33-9"></a>  ndens <span class="ot">&lt;-</span> <span class="fu">names</span>(dens)</span>
<span id="cb33-10"><a href="#cb33-10"></a>  </span>
<span id="cb33-11"><a href="#cb33-11"></a>  fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> data, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb33-12"><a href="#cb33-12"></a>  def.par <span class="ot">=</span> <span class="fu">par</span>(<span class="at">no.readonly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-13"><a href="#cb33-13"></a>  </span>
<span id="cb33-14"><a href="#cb33-14"></a>  xlim <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(<span class="fu">sapply</span>(dens, <span class="cf">function</span>(x) <span class="fu">min</span>(x<span class="sc">$</span>x))),</span>
<span id="cb33-15"><a href="#cb33-15"></a>            <span class="fu">max</span>(<span class="fu">sapply</span>(dens, <span class="cf">function</span>(x) <span class="fu">max</span>(x<span class="sc">$</span>x))))</span>
<span id="cb33-16"><a href="#cb33-16"></a>  </span>
<span id="cb33-17"><a href="#cb33-17"></a>  ylim <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(<span class="fu">sapply</span>(dens, <span class="cf">function</span>(x) <span class="fu">max</span>(x<span class="sc">$</span>y))))</span>
<span id="cb33-18"><a href="#cb33-18"></a>  </span>
<span id="cb33-19"><a href="#cb33-19"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb33-20"><a href="#cb33-20"></a>  </span>
<span id="cb33-21"><a href="#cb33-21"></a>  <span class="fu">plot</span>(dens[[<span class="dv">1</span>]],</span>
<span id="cb33-22"><a href="#cb33-22"></a>       <span class="at">main =</span> <span class="st">"Density Plot"</span>,</span>
<span id="cb33-23"><a href="#cb33-23"></a>       <span class="at">xlab =</span> x,</span>
<span id="cb33-24"><a href="#cb33-24"></a>       <span class="at">col =</span> <span class="st">"firebrick"</span>,</span>
<span id="cb33-25"><a href="#cb33-25"></a>       <span class="at">lwd =</span> <span class="fl">1.5</span>,</span>
<span id="cb33-26"><a href="#cb33-26"></a>       <span class="at">xlim =</span> xlim,</span>
<span id="cb33-27"><a href="#cb33-27"></a>       <span class="at">ylim =</span> ylim)</span>
<span id="cb33-28"><a href="#cb33-28"></a>  <span class="fu">rug</span>(data[[x]][data[[y]] <span class="sc">==</span> ndens[<span class="dv">1</span>]], <span class="at">col =</span> <span class="st">"firebrick"</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>)</span>
<span id="cb33-29"><a href="#cb33-29"></a>  <span class="fu">rug</span>(data[[x]][data[[y]] <span class="sc">==</span> ndens[<span class="dv">2</span>]], <span class="at">col =</span> <span class="st">"dodgerblue3"</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>)</span>
<span id="cb33-30"><a href="#cb33-30"></a>  <span class="fu">lines</span>(dens[[<span class="dv">2</span>]], <span class="at">col =</span> <span class="st">"dodgerblue3"</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>)</span>
<span id="cb33-31"><a href="#cb33-31"></a>  </span>
<span id="cb33-32"><a href="#cb33-32"></a>  xr <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(data[[x]]), <span class="fu">max</span>(data[[x]]), <span class="at">length.out =</span> <span class="dv">500</span>)</span>
<span id="cb33-33"><a href="#cb33-33"></a>  pdata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(xr)</span>
<span id="cb33-34"><a href="#cb33-34"></a>  <span class="fu">names</span>(pdata) <span class="ot">&lt;-</span> x</span>
<span id="cb33-35"><a href="#cb33-35"></a>  pr <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit, <span class="at">newdata =</span> pdata, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb33-36"><a href="#cb33-36"></a>  </span>
<span id="cb33-37"><a href="#cb33-37"></a>  y_jitt <span class="ot">&lt;-</span> <span class="fu">jitter</span>(data[[y]], <span class="fl">0.2</span>)</span>
<span id="cb33-38"><a href="#cb33-38"></a>  y_col <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(data[[y]] <span class="sc">==</span> ndens[<span class="dv">1</span>], <span class="st">"firebrick"</span>, <span class="st">"dodgerblue3"</span>)</span>
<span id="cb33-39"><a href="#cb33-39"></a>  </span>
<span id="cb33-40"><a href="#cb33-40"></a>  <span class="fu">plot</span>(data[[x]], y_jitt, </span>
<span id="cb33-41"><a href="#cb33-41"></a>       <span class="at">col =</span> scales<span class="sc">::</span><span class="fu">alpha</span>(y_col, <span class="fl">0.4</span>),</span>
<span id="cb33-42"><a href="#cb33-42"></a>       <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb33-43"><a href="#cb33-43"></a>       <span class="at">main =</span> <span class="st">"Dotplot"</span>,</span>
<span id="cb33-44"><a href="#cb33-44"></a>       <span class="at">xlab =</span> x,</span>
<span id="cb33-45"><a href="#cb33-45"></a>       <span class="at">ylab =</span> y)</span>
<span id="cb33-46"><a href="#cb33-46"></a>  <span class="fu">lines</span>(pdata[[<span class="dv">1</span>]], pr)</span>
<span id="cb33-47"><a href="#cb33-47"></a>  </span>
<span id="cb33-48"><a href="#cb33-48"></a>  <span class="fu">par</span>(def.par)</span>
<span id="cb33-49"><a href="#cb33-49"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-simulation-4" class="slide level2 extra">
<h2>Data Simulation</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a>fit_roc <span class="ot">&lt;-</span> pROC<span class="sc">::</span><span class="fu">roc</span>(y <span class="sc">~</span> x, <span class="at">data =</span> dat)</span>
<span id="cb34-2"><a href="#cb34-2"></a>fit_roc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
roc.formula(formula = y ~ x, data = dat)

Data: x in 50 controls (y 0) &lt; 50 cases (y 1).
Area under the curve: 0.742</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a>fit_roc <span class="sc">|&gt;</span> </span>
<span id="cb36-2"><a href="#cb36-2"></a>  pROC<span class="sc">::</span><span class="fu">ggroc</span>() <span class="sc">+</span> </span>
<span id="cb36-3"><a href="#cb36-3"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"darkgrey"</span>) <span class="sc">+</span></span>
<span id="cb36-4"><a href="#cb36-4"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb36-5"><a href="#cb36-5"></a>  <span class="fu">theme_minimal</span>(<span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb36-6"><a href="#cb36-6"></a>  <span class="fu">xlab</span>(<span class="st">"Specificity"</span>) <span class="sc">+</span></span>
<span id="cb36-7"><a href="#cb36-7"></a>  <span class="fu">ylab</span>(<span class="st">"Sensitivity"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="03-biostatistics_files/figure-revealjs/unnamed-chunk-49-1.svg" width="960" class="r-stretch quarto-figure-center"></section>
<section id="data-simulation-5" class="slide level2 extra">
<h2>Data Simulation</h2>
<p>Or manually using the <code>classify()</code> function that compute common classification metrics given one or more thresholds <span class="math inline">\(c_i\)</span>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>classify <span class="ot">&lt;-</span> <span class="cf">function</span>(data, y, x, c, <span class="at">na.rm =</span> <span class="cn">FALSE</span>){</span>
<span id="cb37-2"><a href="#cb37-2"></a>  xn <span class="ot">&lt;-</span> <span class="fu">deparse</span>(<span class="fu">substitute</span>(x))</span>
<span id="cb37-3"><a href="#cb37-3"></a>  yn <span class="ot">&lt;-</span> <span class="fu">deparse</span>(<span class="fu">substitute</span>(y))</span>
<span id="cb37-4"><a href="#cb37-4"></a>  </span>
<span id="cb37-5"><a href="#cb37-5"></a>  <span class="cf">if</span>(na.rm){</span>
<span id="cb37-6"><a href="#cb37-6"></a>    data <span class="ot">&lt;-</span> data[<span class="fu">complete.cases</span>(data[, <span class="fu">c</span>(xn, yn)]), ]</span>
<span id="cb37-7"><a href="#cb37-7"></a>  }</span>
<span id="cb37-8"><a href="#cb37-8"></a>  </span>
<span id="cb37-9"><a href="#cb37-9"></a>  confusion <span class="ot">&lt;-</span> <span class="fu">lapply</span>(c, <span class="cf">function</span>(cr){</span>
<span id="cb37-10"><a href="#cb37-10"></a>    <span class="co"># classify based on c</span></span>
<span id="cb37-11"><a href="#cb37-11"></a>    yp <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(data[[xn]] <span class="sc">&gt;=</span> cr, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb37-12"><a href="#cb37-12"></a>    </span>
<span id="cb37-13"><a href="#cb37-13"></a>    out <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb37-14"><a href="#cb37-14"></a>      <span class="at">tp =</span> <span class="fu">sum</span>(data[[yn]] <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> yp <span class="sc">==</span> <span class="dv">1</span>),</span>
<span id="cb37-15"><a href="#cb37-15"></a>      <span class="at">fp =</span> <span class="fu">sum</span>(data[[yn]] <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> yp <span class="sc">==</span> <span class="dv">1</span>),</span>
<span id="cb37-16"><a href="#cb37-16"></a>      <span class="at">tn =</span> <span class="fu">sum</span>(data[[yn]] <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> yp <span class="sc">==</span> <span class="dv">0</span>),</span>
<span id="cb37-17"><a href="#cb37-17"></a>      <span class="at">fn =</span> <span class="fu">sum</span>(data[[yn]] <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> yp <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb37-18"><a href="#cb37-18"></a>    )</span>
<span id="cb37-19"><a href="#cb37-19"></a>    </span>
<span id="cb37-20"><a href="#cb37-20"></a>    <span class="co"># rates</span></span>
<span id="cb37-21"><a href="#cb37-21"></a>    out<span class="sc">$</span>tpr <span class="ot">&lt;-</span> <span class="fu">with</span>(out, tp <span class="sc">/</span> (tp <span class="sc">+</span> fn))</span>
<span id="cb37-22"><a href="#cb37-22"></a>    out<span class="sc">$</span>fpr <span class="ot">&lt;-</span> <span class="fu">with</span>(out, fp <span class="sc">/</span> (fp <span class="sc">+</span> tn))</span>
<span id="cb37-23"><a href="#cb37-23"></a>    out<span class="sc">$</span>tnr <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> out<span class="sc">$</span>fpr</span>
<span id="cb37-24"><a href="#cb37-24"></a>    out<span class="sc">$</span>fnr <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> out<span class="sc">$</span>tpr</span>
<span id="cb37-25"><a href="#cb37-25"></a>    out<span class="sc">$</span>tot <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data)</span>
<span id="cb37-26"><a href="#cb37-26"></a>    out<span class="sc">$</span>prevalence <span class="ot">&lt;-</span> <span class="fu">mean</span>(data[[yn]] <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb37-27"><a href="#cb37-27"></a>    out<span class="sc">$</span>c <span class="ot">&lt;-</span> cr</span>
<span id="cb37-28"><a href="#cb37-28"></a>    out<span class="sc">$</span>ppv <span class="ot">&lt;-</span> <span class="fu">with</span>(out, tp <span class="sc">/</span> (tp <span class="sc">+</span> fp))</span>
<span id="cb37-29"><a href="#cb37-29"></a>    out<span class="sc">$</span>npv <span class="ot">&lt;-</span> <span class="fu">with</span>(out, tn <span class="sc">/</span> (tn <span class="sc">+</span> fn))</span>
<span id="cb37-30"><a href="#cb37-30"></a>    out</span>
<span id="cb37-31"><a href="#cb37-31"></a>  })</span>
<span id="cb37-32"><a href="#cb37-32"></a>  </span>
<span id="cb37-33"><a href="#cb37-33"></a>  <span class="fu">do.call</span>(rbind, confusion)</span>
<span id="cb37-34"><a href="#cb37-34"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-simulation-6" class="slide level2 extra">
<h2>Data Simulation</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="fu">classify</span>(dat, y, x, <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  tp fp tn fn tpr  fpr  tnr fnr tot prevalence c       ppv    npv
1 35 17 33 15 0.7 0.34 0.66 0.3 100        0.5 0 0.6730769 0.6875</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="fu">classify</span>(dat, y, x, <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  tp fp tn fn  tpr  fpr  tnr  fnr tot prevalence  c       ppv       npv
1 47 36 14  3 0.94 0.72 0.28 0.06 100        0.5 -1 0.5662651 0.8235294
2 35 17 33 15 0.70 0.34 0.66 0.30 100        0.5  0 0.6730769 0.6875000
3 15  3 47 35 0.30 0.06 0.94 0.70 100        0.5  1 0.8333333 0.5731707</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="co"># ~ full roc curve</span></span>
<span id="cb42-2"><a href="#cb42-2"></a>cs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>, <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="fl">0.1</span>), <span class="cn">Inf</span>)</span>
<span id="cb42-3"><a href="#cb42-3"></a>car<span class="sc">::</span><span class="fu">some</span>(<span class="fu">classify</span>(dat, y, x, cs))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   tp fp tn fn  tpr  fpr  tnr  fnr tot prevalence    c       ppv       npv
12 50 50  0  0 1.00 1.00 0.00 0.00 100        0.5 -3.0 0.5000000       NaN
18 50 49  1  0 1.00 0.98 0.02 0.00 100        0.5 -2.4 0.5050505 1.0000000
25 49 45  5  1 0.98 0.90 0.10 0.02 100        0.5 -1.7 0.5212766 0.8333333
27 49 42  8  1 0.98 0.84 0.16 0.02 100        0.5 -1.5 0.5384615 0.8888889
43 31 16 34 19 0.62 0.32 0.68 0.38 100        0.5  0.1 0.6595745 0.6415094
46 26 10 40 24 0.52 0.20 0.80 0.48 100        0.5  0.4 0.7222222 0.6250000
54 12  1 49 38 0.24 0.02 0.98 0.76 100        0.5  1.2 0.9230769 0.5632184
56  8  0 50 42 0.16 0.00 1.00 0.84 100        0.5  1.4 1.0000000 0.5434783
64  3  0 50 47 0.06 0.00 1.00 0.94 100        0.5  2.2 1.0000000 0.5154639
80  0  0 50 50 0.00 0.00 1.00 1.00 100        0.5  3.8       NaN 0.5000000</code></pre>
</div>
</div>
</section>
<section id="data-simulation-7" class="slide level2 extra">
<h2>Data Simulation</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a>cr <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="fl">0.1</span>) <span class="co"># vector of thresholds</span></span>
<span id="cb44-2"><a href="#cb44-2"></a>cmat <span class="ot">&lt;-</span> <span class="fu">classify</span>(dat, y, x, cr)</span>
<span id="cb44-3"><a href="#cb44-3"></a></span>
<span id="cb44-4"><a href="#cb44-4"></a><span class="fu">plot</span>(cmat<span class="sc">$</span>tnr, cmat<span class="sc">$</span>tpr, <span class="at">xlim =</span> <span class="fu">rev</span>(<span class="fu">range</span>(cmat<span class="sc">$</span>tpr)), <span class="at">type =</span> <span class="st">"l"</span>,</span>
<span id="cb44-5"><a href="#cb44-5"></a>     <span class="at">xlab =</span> <span class="st">"Specificity"</span>,</span>
<span id="cb44-6"><a href="#cb44-6"></a>     <span class="at">ylab =</span> <span class="st">"Sensitivity"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="03-biostatistics_files/figure-revealjs/unnamed-chunk-52-1.svg" width="960" class="r-stretch quarto-figure-center"></section></section>
<section>
<section id="application-to-genetic-data" class="title-slide slide level1 section center">
<h1>Application to genetic data</h1>

</section>
<section id="objectives" class="slide level2">
<h2>Objectives</h2>
<p>Moving to our <code>curatedOvarianData</code> dataset, we want to explore how the information from genes (<span class="math inline">\(g\)</span>) expression predict the <strong>debulking</strong> probability.</p>
<blockquote>
<p>The term <strong>debulking</strong> represent the patient’s surgery success in removing the tumor mass (<em>optimal debulking</em>) vs the insuccess in removing the tumor mass (<em>suboptimal debulking</em>)</p>
</blockquote>
<p>Some questions are:</p>
<ul>
<li>how different genes predict the <strong>debulking</strong> status</li>
<li>how results from a given gene <span class="math inline">\(g_i\)</span> change, using a different dataset</li>
</ul>
</section>
<section id="conventions-and-notation" class="slide level2">
<h2>Conventions and notation</h2>
<p>We saw that working with contingency tables requires giving labels to the actual data. In this case we set the following conventions:</p>
<ul>
<li>the <strong>suboptimal</strong> state is coded as 0 i.e.&nbsp;having the <em>disease</em></li>
<li>the <strong>optimal</strong> state is coded as 1 i.e.&nbsp;not having the <em>disease</em></li>
<li>higher values of gene expressions (<span class="math inline">\(x_{g_i}\)</span>) are associated with higher probability of <strong>suboptimal</strong> state</li>
<li>we call the <strong>state</strong> (S) the variable representing the <em>TRUE</em> surgery outcome and <strong>test</strong> (T) the predicted outcome using the gene expression. Thus e.g.&nbsp;<span class="math inline">\(p(T_1|S_1)\)</span> is the Sensitivity</li>
</ul>
</section>
<section id="steps" class="slide level2">
<h2>Steps</h2>
<ol type="1">
<li>Load and explore the data (you can the <code>ovarianclean.rds</code> or using the raw <code>curatedOvarianData</code>)</li>
<li>Calculate the prevalence (<span class="math inline">\(p(S_1)\)</span>) of the <strong>optimal</strong> debulking for each dataset</li>
<li>Choose a gene (<span class="math inline">\(g_i\)</span>) and plot the <span class="math inline">\(x_i\)</span> values according to the debulking</li>
<li>Calculate the Sensitivity, Specificity, Youden’s J and PPV for all datasets based on the same gene.</li>
<li>Compare graphically and descriptively the results</li>
<li>Calculate the standard error of the AUC (see the <code>pROC::var()</code> function)</li>
<li>Compute and represent a <strong>random-effects meta-analysis</strong> polling the AUC for the same gene, across datasets. Interpret the pooled effect, heterogeneity and Q-statistics.</li>
</ol>
</section>
<section id="steps-optional" class="slide level2">
<h2>Steps (optional)</h2>
<ol start="6" type="1">
<li>[Extra] Try to compute the standard error of the AUC using a <em>bootstrapping</em> approach. Essentially you need to sample with replacement (see <code>sample()</code>) <span class="math inline">\(n\)</span> rows from the dataset (where <span class="math inline">\(n\)</span> is the total number of rows), compute and store the AUC, repeat the process several times (at least 10000 times), calculate the standard deviation of the boostrapped AUC distribution.</li>
</ol>
<ul>
<li>There is also the <code>pROC::ci.auc()</code> function with the <code>bootstrap</code> option. Try to manually code the bootstrap and eventually compare the results</li>
<li>The confidence interval can be calculated with the <code>quantile()</code> function <span class="citation" data-cites="Carpenter2000-dm">(see <a href="#/references-download-.bib-file" role="doc-biblioref" onclick="">Carpenter &amp; Bithell, 2000</a>)</span> with the desired coverage (e.g., 95%)</li>
<li>Further details are available here https://cran.r-project.org/web/packages/pROC/pROC.pdf (page 5, Section Bootstrap)</li>
</ul>
</section>
<section id="references-download-.bib-file" class="slide level2 smaller scrollable">
<h2>References <button class="btn"><i class="fa fa-download"></i><a href="data:text/x-bibtex;base64,QEFSVElDTEV7QnJlbm5lcjE5OTcteXEsDQogIHRpdGxlID0ge1ZhcmlhdGlvbiBvZiBzZW5zaXRpdml0eSwgc3BlY2lmaWNpdHksIGxpa2VsaWhvb2QgcmF0aW9zIGFuZA0KICBwcmVkaWN0aXZlIHZhbHVlcyB3aXRoIGRpc2Vhc2UgcHJldmFsZW5jZX0sDQogIGF1dGhvciA9IHtCcmVubmVyLCBIIGFuZCBHZWZlbGxlciwgT30sDQogIGpvdXJuYWx0aXRsZSA9IHtTdGF0LiBNZWQufSwNCiAgcHVibGlzaGVyID0ge1dpbGV5fSwNCiAgdm9sdW1lID0gezE2fSwNCiAgaXNzdWUgPSB7OX0sDQogIHBhZ2VzID0gezk4MS05OTF9LA0KICBkYXRlID0gezE5OTctMDUtMTV9LA0KICBkb2kgPSB7MTAuMTAwMi8oc2ljaSkxMDk3LTAyNTgoMTk5NzA1MTUpMTY6OTw5ODE6OmFpZC1zaW01MTA+My4wLmNvOzItbn0sDQogIHBtaWQgPSB7OTE2MDQ5M30sDQogIGlzc24gPSB7MTA5Ny0wMjU4LDAyNzctNjcxNX0sDQogIGFic3RyYWN0ID0ge1RoZSBzZW5zaXRpdml0eSwgc3BlY2lmaWNpdHkgYW5kIGxpa2VsaWhvb2QgcmF0aW9zIG9mIGJpbmFyeQ0KICBkaWFnbm9zdGljIHRlc3RzIGFyZSBvZnRlbiB0aG91Z2h0IG9mIGFzIGJlaW5nIGluZGVwZW5kZW50IG9mIGRpc2Vhc2UNCiAgcHJldmFsZW5jZS4gRW1waXJpY2FsIHN0dWRpZXMsIGhvd2V2ZXIsIGhhdmUgZnJlcXVlbnRseSByZXZlYWxlZCBzdWJzdGFudGlhbA0KICB2YXJpYXRpb24gb2YgdGhlc2UgbWVhc3VyZXMgZm9yIHRoZSBzYW1lIGRpYWdub3N0aWMgdGVzdCBpbiBkaWZmZXJlbnQNCiAgcG9wdWxhdGlvbnMuIE9uZSByZWFzb24gZm9yIHRoaXMgZGlzY3JlcGFuY3kgaXMgcmVsYXRlZCB0byB0aGUgZmFjdCB0aGF0IG9ubHkNCiAgZmV3IGRpYWdub3N0aWMgdGVzdHMgYXJlIGluaGVyZW50bHkgZGljaG90b21vdXMuIFRoZSBtYWpvcml0eSBvZiB0ZXN0cyBhcmUNCiAgYmFzZWQgb24gY2F0ZWdvcml6YXRpb24gb2YgaW5kaXZpZHVhbHMgYWNjb3JkaW5nIHRvIG9uZSBvciBzZXZlcmFsIHVuZGVybHlpbmcNCiAgY29udGludW91cyB0cmFpdHMuIEZvciB0aGVzZSB0ZXN0cywgdGhlIG1hZ25pdHVkZSBvZiBkaWFnbm9zdGljDQogIG1pc2NsYXNzaWZpY2F0aW9uIGRlcGVuZHMgbm90IG9ubHkgb24gdGhlIG1hZ25pdHVkZSBvZiB0aGUgbWVhc3VyZW1lbnQgb3INCiAgcGVyY2VwdGlvbiBlcnJvciBvZiB0aGUgdW5kZXJseWluZyB0cmFpdChzKSwgYnV0IGFsc28gb24gdGhlIGRpc3RyaWJ1dGlvbiBvZg0KICB0aGUgdW5kZXJseWluZyB0cmFpdChzKSBpbiB0aGUgcG9wdWxhdGlvbiByZWxhdGl2ZSB0byB0aGUgZGlhZ25vc3RpYyBjdXRwb2ludC4NCiAgU2luY2UgdGhpcyBkaXN0cmlidXRpb24gYWxzbyBkZXRlcm1pbmVzIHByZXZhbGVuY2Ugb2YgdGhlIGRpc2Vhc2UgaW4gdGhlDQogIHBvcHVsYXRpb24sIGRpYWdub3N0aWMgbWlzY2xhc3NpZmljYXRpb24gYW5kIGRpc2Vhc2UgcHJldmFsZW5jZSBhcmUgcmVsYXRlZA0KICBmb3IgdGhpcyB0eXBlIG9mIHRlc3QuIFdlIGFzc2VzcyB0aGUgdmFyaWF0aW9uIG9mIHZhcmlvdXMgbWVhc3VyZXMgb2YgdmFsaWRpdHkNCiAgb2YgZGlhZ25vc3RpYyB0ZXN0cyB3aXRoIGRpc2Vhc2UgcHJldmFsZW5jZSBmb3Igc2ltcGxlIG1vZGVscyBvZiB0aGUNCiAgZGlzdHJpYnV0aW9uIG9mIHRoZSB1bmRlcmx5aW5nIHRyYWl0KHMpIGFuZCB0aGUgbWVhc3VyZW1lbnQgb3IgcGVyY2VwdGlvbg0KICBlcnJvci4gV2UgaWxsdXN0cmF0ZSB0aGF0IHZhcmlhdGlvbiB3aXRoIGRpc2Vhc2UgcHJldmFsZW5jZSBpcyB0eXBpY2FsbHkNCiAgc3Ryb25nIGZvciBzZW5zaXRpdml0eSBhbmQgc3BlY2lmaWNpdHksIGFuZCBldmVuIG1vcmUgc28gZm9yIHRoZSBsaWtlbGlob29kDQogIHJhdGlvcy4gQWx0aG91Z2ggcG9zaXRpdmUgYW5kIG5lZ2F0aXZlIHByZWRpY3RpdmUgdmFsdWVzIGFsc28gc3Ryb25nbHkgdmFyeQ0KICB3aXRoIGRpc2Vhc2UgcHJldmFsZW5jZSwgdGhpcyB2YXJpYXRpb24gaXMgdXN1YWxseSBsZXNzIHByb25vdW5jZWQgdGhhbiBvbmUNCiAgd291bGQgZXhwZWN0IGlmIHNlbnNpdGl2aXR5IGFuZCBzcGVjaWZpY2l0eSB3ZXJlIGluZGVwZW5kZW50IG9mIGRpc2Vhc2UNCiAgcHJldmFsZW5jZS59LA0KICB1cmwgPSB7aHR0cHM6Ly9vbmxpbmVsaWJyYXJ5LndpbGV5LmNvbS9kb2kvYWJzLzEwLjEwMDIvJTI4U0lDSSUyOTEwOTctMDI1OCUyODE5OTcwNTE1JTI5MTYlM0E5JTNDOTgxJTNBJTNBQUlELVNJTTUxMCUzRTMuMC5DTyUzQjItTn0sDQogIHVybGRhdGUgPSB7MjAyMy0wOC0xOH0sDQogIGxhbmd1YWdlID0ge2VufQ0KfQ0KDQpAVU5QVUJMSVNIRUR7UGFybWlnaWFuaTIwMjMtZHIsDQogIHRpdGxlID0ge0RlZmluaW5nIHJlcGxpY2FiaWxpdHkgb2YgcHJlZGljdGlvbiBydWxlc30sDQogIGF1dGhvciA9IHtQYXJtaWdpYW5pLCBHaW92YW5uaX0sDQogIGpvdXJuYWx0aXRsZSA9IHthclhpdiBbc3RhdC5NRV19LA0KICBkYXRlID0gezIwMjMtMDQtMzB9LA0KICBlcHJpbnQgPSB7MjMwNS4wMTUxOH0sDQogIGVwcmludGNsYXNzID0ge3N0YXQuTUV9LA0KICBhYnN0cmFjdCA9IHtJbiB0aGlzIGFydGljbGUgSSBwcm9wb3NlIGFuIGFwcHJvYWNoIGZvciBkZWZpbmluZyByZXBsaWNhYmlsaXR5DQogIGZvciBwcmVkaWN0aW9uIHJ1bGVzLiBNb3RpdmF0ZWQgYnkgYSByZWNlbnQgTkFTIHJlcG9ydCwgSSBzdGFydCBmcm9tIHRoZQ0KICBwZXJzcGVjdGl2ZSB0aGF0IHJlcGxpY2FiaWxpdHkgaXMgb2J0YWluaW5nIGNvbnNpc3RlbnQgcmVzdWx0cyBhY3Jvc3Mgc3R1ZGllcw0KICBzdWl0YWJsZSB0byBhZGRyZXNzIHRoZSBzYW1lIHByZWRpY3Rpb24gcXVlc3Rpb24sIGVhY2ggb2Ygd2hpY2ggaGFzIG9idGFpbmVkDQogIGl0cyBvd24gZGF0YS4gSSB0aGVuIGRpc2N1c3MgY29uY2VwdCBhbmQgaXNzdWVzIGluIGRlZmluaW5nIGtleSBlbGVtZW50cyBvZg0KICB0aGlzIHN0YXRlbWVudC4gSSBmb2N1cyBzcGVjaWZpY2FsbHkgb24gdGhlIG1lYW5pbmcgb2YgImNvbnNpc3RlbnQgcmVzdWx0cyIgaW4NCiAgdHlwaWNhbCB1dGlsaXphdGlvbiBjb250ZXh0cywgYW5kIHByb3Bvc2UgYSBtdWx0aS1hZ2VudCBmcmFtZXdvcmsgZm9yIGRlZmluaW5nDQogIHJlcGxpY2FiaWxpdHksIGluIHdoaWNoIGFnZW50cyBhcmUgbmVpdGhlciBwYXJ0bmVycyBub3IgYWR2ZXJzYXJpZXMuIEkgcmVjb3Zlcg0KICBzb21lIG9mIHRoZSBwcmV2YWxlbnQgcHJhY3RpY2FsIGFwcHJvYWNoZXMgYXMgc3BlY2lhbCBjYXNlcy4gSSBob3BlIHRvIHByb3ZpZGUNCiAgZ3VpZGFuY2UgZm9yIGEgbW9yZSBzeXN0ZW1hdGljIGFzc2Vzc21lbnQgb2YgcmVwbGljYWJpbGl0eSBpbiBtYWNoaW5lDQogIGxlYXJuaW5nLn0sDQogIHVybCA9IHtodHRwOi8vYXJ4aXYub3JnL2Ficy8yMzA1LjAxNTE4fSwNCiAgdXJsZGF0ZSA9IHsyMDIzLTA4LTIyfQ0KfQ0KDQpAQVJUSUNMRXtDYXJwZW50ZXIyMDAwLWRtLA0KICB0aXRsZSA9IHtCb290c3RyYXAgY29uZmlkZW5jZSBpbnRlcnZhbHM6IHdoZW4sIHdoaWNoLCB3aGF0PyBBIHByYWN0aWNhbCBndWlkZQ0KICBmb3IgbWVkaWNhbCBzdGF0aXN0aWNpYW5zfSwNCiAgYXV0aG9yID0ge0NhcnBlbnRlciwgSiBhbmQgQml0aGVsbCwgSn0sDQogIGpvdXJuYWx0aXRsZSA9IHtTdGF0LiBNZWQufSwNCiAgcHVibGlzaGVyID0ge1dpbGV5fSwNCiAgdm9sdW1lID0gezE5fSwNCiAgaXNzdWUgPSB7OX0sDQogIHBhZ2VzID0gezExNDEtMTE2NH0sDQogIGRhdGUgPSB7MjAwMC0wNS0xNX0sDQogIGRvaSA9IHsxMC4xMDAyLyhzaWNpKTEwOTctMDI1OCgyMDAwMDUxNSkxOTo5PDExNDE6OmFpZC1zaW00Nzk+My4wLmNvOzItZn0sDQogIHBtaWQgPSB7MTA3OTc1MTN9LA0KICBpc3NuID0gezEwOTctMDI1OCwwMjc3LTY3MTV9LA0KICBhYnN0cmFjdCA9IHtTaW5jZSB0aGUgZWFybHkgMTk4MHMsIGEgYmV3aWxkZXJpbmcgYXJyYXkgb2YgbWV0aG9kcyBmb3INCiAgY29uc3RydWN0aW5nIGJvb3RzdHJhcCBjb25maWRlbmNlIGludGVydmFscyBoYXZlIGJlZW4gcHJvcG9zZWQuIEluIHRoaXMNCiAgYXJ0aWNsZSwgd2UgYWRkcmVzcyB0aGUgZm9sbG93aW5nIHF1ZXN0aW9ucy4gRmlyc3QsIHdoZW4gc2hvdWxkIGJvb3RzdHJhcA0KICBjb25maWRlbmNlIGludGVydmFscyBiZSB1c2VkLiBTZWNvbmRseSwgd2hpY2ggbWV0aG9kIHNob3VsZCBiZSBjaG9zZW4sIGFuZA0KICB0aGlyZGx5LCBob3cgc2hvdWxkIGl0IGJlIGltcGxlbWVudGVkLiBJbiBvcmRlciB0byBkbyB0aGlzLCB3ZSByZXZpZXcgdGhlDQogIGNvbW1vbiBhbGdvcml0aG1zIGZvciByZXNhbXBsaW5nIGFuZCBtZXRob2RzIGZvciBjb25zdHJ1Y3RpbmcgYm9vdHN0cmFwDQogIGNvbmZpZGVuY2UgaW50ZXJ2YWxzLCB0b2dldGhlciB3aXRoIHNvbWUgbGVzcyB3ZWxsIGtub3duIG9uZXMsIGhpZ2hsaWdodGluZw0KICB0aGVpciBzdHJlbmd0aHMgYW5kIHdlYWtuZXNzZXMuIFdlIHRoZW4gcHJlc2VudCBhIHNpbXVsYXRpb24gc3R1ZHksIGEgZmxvdw0KICBjaGFydCBmb3IgY2hvb3NpbmcgYW4gYXBwcm9wcmlhdGUgbWV0aG9kIGFuZCBhIHN1cnZpdmFsIGFuYWx5c2lzIGV4YW1wbGUufSwNCiAgdXJsID0ge2h0dHBzOi8vb25saW5lbGlicmFyeS53aWxleS5jb20vZG9pL2Ficy8xMC4xMDAyLyUyOFNJQ0klMjkxMDk3LTAyNTglMjgyMDAwMDUxNSUyOTE5JTNBOSUzQzExNDElM0ElM0FBSUQtU0lNNDc5JTNFMy4wLkNPJTNCMi1GfSwNCiAgdXJsZGF0ZSA9IHsyMDIzLTA4LTIzfSwNCiAgbGFuZ3VhZ2UgPSB7ZW59DQp9DQoNCkBBUlRJQ0xFe01hc29lcm8yMDIzLXdiLA0KICB0aXRsZSA9IHtDcm9zcy1TdHVkeSBSZXBsaWNhYmlsaXR5IGluIENsdXN0ZXIgQW5hbHlzaXN9LA0KICBhdXRob3IgPSB7TWFzb2VybywgTG9yZW56byBhbmQgVGhvbWFzLCBFbW1hIGFuZCBQYXJtaWdpYW5pLCBHaW92YW5uaSBhbmQNCiAgVHlla3VjaGV2YSwgU3ZpdGxhbmEgYW5kIFRyaXBwYSwgTG9yZW56b30sDQogIGpvdXJuYWx0aXRsZSA9IHtTdGF0LiBTY2kufSwNCiAgcHVibGlzaGVyID0ge0luc3RpdHV0ZSBvZiBNYXRoZW1hdGljYWwgU3RhdGlzdGljc30sDQogIHZvbHVtZSA9IHszOH0sDQogIGlzc3VlID0gezJ9LA0KICBwYWdlcyA9IHszMDMtMzE2fSwNCiAgZGF0ZSA9IHsyMDIzLTA1LTAxfSwNCiAgZG9pID0gezEwLjEyMTQvMjItc3RzODcxfSwNCiAgaXNzbiA9IHswODgzLTQyMzcsMjE2OC04NzQ1fSwNCiAgYWJzdHJhY3QgPSB7SW4gY2FuY2VyIHJlc2VhcmNoLCBjbHVzdGVyaW5nIHRlY2huaXF1ZXMgYXJlIHdpZGVseSB1c2VkIGZvcg0KICBleHBsb3JhdG9yeSBhbmFseXNlcywgcGxheWluZyBhIGNyaXRpY2FsIHJvbGUgaW4gdGhlIGlkZW50aWZpY2F0aW9uIG9mIG5vdmVsDQogIGNhbmNlciBzdWJ0eXBlcyBhbmQgcGF0aWVudCBtYW5hZ2VtZW50LiBBcyBkYXRhIGNvbGxlY3RlZCBieSBtdWx0aXBsZSByZXNlYXJjaA0KICBncm91cHMgZ3Jvd3MsIGl0IGlzIGluY3JlYXNpbmdseSBmZWFzaWJsZSB0byBpbnZlc3RpZ2F0ZSB0aGUgcmVwbGljYWJpbGl0eSBvZg0KICBjbHVzdGVyaW5nIHByb2NlZHVyZXMsIHRoYXQgaXMsIHRoZWlyIGFiaWxpdHkgdG8gY29uc2lzdGVudGx5IHJlY292ZXINCiAgYmlvbG9naWNhbGx5IG1lYW5pbmdmdWwgY2x1c3RlcnMgYWNyb3NzIHNldmVyYWwgZGF0YSBzZXRzLiBJbiB0aGlzIHBhcGVyLCB3ZQ0KICByZXZpZXcgbWV0aG9kcyBmb3IgcmVwbGljYWJpbGl0eSBvZiBjbHVzdGVyaW5nIGFuYWx5c2VzLCBhbmQgZGlzY3VzcyBhIG5vdmVsDQogIGZyYW1ld29yayBmb3IgZXZhbHVhdGluZyBjcm9zcy1zdHVkeSBjbHVzdGVyaW5nIHJlcGxpY2FiaWxpdHksIHVzZWZ1bCB3aGVuIHR3bw0KICBvciBtb3JlIHN0dWRpZXMgYXJlIGF2YWlsYWJsZS4gT3VyIGFwcHJvYWNoIGNhbiBiZSBhcHBsaWVkIHRvIGFueSBjbHVzdGVyaW5nDQogIGFsZ29yaXRobSBhbmQgY2FuIGVtcGxveSBkaWZmZXJlbnQgbWVhc3VyZXMgb2Ygc2ltaWxhcml0eSBiZXR3ZWVuIHBhcnRpdGlvbnMNCiAgdG8gcXVhbnRpZnkgcmVwbGljYWJpbGl0eSwgZ2xvYmFsbHkgKGkuZS4sIGZvciB0aGUgd2hvbGUgc2FtcGxlKSBhcyB3ZWxsIGFzDQogIGxvY2FsbHkgKGkuZS4sIGZvciBpbmRpdmlkdWFsIGNsdXN0ZXJzKS4gVXNpbmcgZXhwZXJpbWVudHMgb24gc3ludGhldGljIGFuZA0KICByZWFsIGdlbmUgZXhwcmVzc2lvbiBkYXRhLCB3ZSBpbGx1c3RyYXRlIHRoZSB1c2VmdWxuZXNzIG9mIG91ciBwcm9jZWR1cmUgdG8NCiAgZXZhbHVhdGUgaWYgdGhlIHNhbWUgY2x1c3RlcnMgYXJlIGlkZW50aWZpZWQgY29uc2lzdGVudGx5IGFjcm9zcyBhIGNvbGxlY3Rpb24NCiAgb2YgZGF0YSBzZXRzLn0sDQogIHVybCA9IHtodHRwczovL3Byb2plY3RldWNsaWQub3JnL2pvdXJuYWxzL3N0YXRpc3RpY2FsLXNjaWVuY2Uvdm9sdW1lLTM4L2lzc3VlLTIvQ3Jvc3MtU3R1ZHktUmVwbGljYWJpbGl0eS1pbi1DbHVzdGVyLUFuYWx5c2lzLzEwLjEyMTQvMjItU1RTODcxLnNob3J0fSwNCiAgdXJsZGF0ZSA9IHsyMDIzLTA4LTIyfSwNCiAga2V5d29yZHMgPSB7Y2x1c3RlcmluZzsgbXVsdGlwbGUgc3R1ZGllczsgcmVwbGljYWJpbGl0eX0sDQogIGxhbmd1YWdlID0ge2VufQ0KfQ0KDQpAQVJUSUNMRXtXYWxkcm9uMjAxNC15diwNCiAgdGl0bGUgPSB7Q29tcGFyYXRpdmUgbWV0YS1hbmFseXNpcyBvZiBwcm9nbm9zdGljIGdlbmUgc2lnbmF0dXJlcyBmb3INCiAgbGF0ZS1zdGFnZSBvdmFyaWFuIGNhbmNlcn0sDQogIGF1dGhvciA9IHtXYWxkcm9uLCBMZXZpIGFuZCBIYWliZS1LYWlucywgQmVuamFtaW4gYW5kIEN1bGhhbmUsIEFlZMOtbiBDIGFuZA0KICBSaWVzdGVyLCBNYXJrdXMgYW5kIERpbmcsIEppZSBhbmQgV2FuZywgWGluIFZpY3RvcmlhIGFuZCBBaG1hZGlmYXIsIE1haG5heiBhbmQNCiAgVHlla3VjaGV2YSwgU3ZpdGxhbmEgYW5kIEJlcm5hdSwgQ2hyaXN0b3BoIGFuZCBSaXNjaCwgVGhvbWFzIGFuZCBHYW56ZnJpZWQsDQogIEJlbmphbWluIEZyZWRlcmljayBhbmQgSHV0dGVuaG93ZXIsIEN1cnRpcyBhbmQgQmlycmVyLCBNaWNoYWVsIGFuZCBQYXJtaWdpYW5pLA0KICBHaW92YW5uaX0sDQogIGpvdXJuYWx0aXRsZSA9IHtKLiBOYXRsLiBDYW5jZXIgSW5zdC59LA0KICBwdWJsaXNoZXIgPSB7T3hmb3JkIFVuaXZlcnNpdHkgUHJlc3MgKE9VUCl9LA0KICB2b2x1bWUgPSB7MTA2fSwNCiAgaXNzdWUgPSB7NX0sDQogIHBhZ2VzID0ge2RqdTA0OX0sDQogIGRhdGUgPSB7MjAxNC0wNC0wM30sDQogIGRvaSA9IHsxMC4xMDkzL2puY2kvZGp1MDQ5fSwNCiAgcG1jID0ge1BNQzQ1ODA1NTR9LA0KICBwbWlkID0gezI0NzAwODAxfSwNCiAgaXNzbiA9IHswMDI3LTg4NzQsMTQ2MC0yMTA1fSwNCiAgYWJzdHJhY3QgPSB7QkFDS0dST1VORDogT3ZhcmlhbiBjYW5jZXIgaXMgdGhlIGZpZnRoIG1vc3QgY29tbW9uIGNhdXNlIG9mDQogIGNhbmNlciBkZWF0aHMgaW4gd29tZW4gaW4gdGhlIFVuaXRlZCBTdGF0ZXMuIE51bWVyb3VzIGdlbmUgc2lnbmF0dXJlcyBvZg0KICBwYXRpZW50IHByb2dub3NpcyBoYXZlIGJlZW4gcHJvcG9zZWQsIGJ1dCBkaXZlcnNlIGRhdGEgYW5kIG1ldGhvZHMgbWFrZSB0aGVzZQ0KICBkaWZmaWN1bHQgdG8gY29tcGFyZSBvciB1c2UgaW4gYSBjbGluaWNhbGx5IG1lYW5pbmdmdWwgd2F5LiBXZSBzb3VnaHQgdG8NCiAgaWRlbnRpZnkgc3VjY2Vzc2Z1bCBwdWJsaXNoZWQgcHJvZ25vc3RpYyBnZW5lIHNpZ25hdHVyZXMgdGhyb3VnaCBzeXN0ZW1hdGljDQogIHZhbGlkYXRpb24gdXNpbmcgcHVibGljIGRhdGEuIE1FVEhPRFM6IEEgc3lzdGVtYXRpYyByZXZpZXcgaWRlbnRpZmllZCAxNA0KICBwcm9nbm9zdGljIG1vZGVscyBmb3IgbGF0ZS1zdGFnZSBvdmFyaWFuIGNhbmNlci4gRm9yIGVhY2gsIHdlIGV2YWx1YXRlZCBpdHMgMSkNCiAgcmVpbXBsZW1lbnRhdGlvbiBhcyBkZXNjcmliZWQgYnkgdGhlIG9yaWdpbmFsIHN0dWR5LCAyKSBwZXJmb3JtYW5jZSBmb3INCiAgcHJvZ25vc2lzIG9mIG92ZXJhbGwgc3Vydml2YWwgaW4gaW5kZXBlbmRlbnQgZGF0YSwgYW5kIDMpIHBlcmZvcm1hbmNlIGNvbXBhcmVkDQogIHdpdGggcmFuZG9tIGdlbmUgc2lnbmF0dXJlcy4gV2UgY29tcGFyZWQgYW5kIHJhbmtlZCBtb2RlbHMgYnkgdmFsaWRhdGlvbiBpbiAxMA0KICBwdWJsaXNoZWQgZGF0YXNldHMgY29tcHJpc2luZyAxMjUxIHByaW1hcmlseSBoaWdoLWdyYWRlLCBsYXRlLXN0YWdlIHNlcm91cw0KICBvdmFyaWFuIGNhbmNlciBwYXRpZW50cy4gQWxsIHRlc3RzIG9mIHN0YXRpc3RpY2FsIHNpZ25pZmljYW5jZSB3ZXJlIHR3by1zaWRlZC4NCiAgUkVTVUxUUzogVHdlbHZlIHB1Ymxpc2hlZCBtb2RlbHMgaGFkIDk1XCUgY29uZmlkZW5jZSBpbnRlcnZhbHMgb2YgdGhlIEMtaW5kZXgNCiAgdGhhdCBkaWQgbm90IGluY2x1ZGUgdGhlIG51bGwgdmFsdWUgb2YgMC41OyBlaWdodCBvdXRwZXJmb3JtZWQgOTcuNVwlIG9mDQogIHNpZ25hdHVyZXMgaW5jbHVkaW5nIHRoZSBzYW1lIG51bWJlciBvZiByYW5kb21seSBzZWxlY3RlZCBnZW5lcyBhbmQgdHJhaW5lZCBvbg0KICB0aGUgc2FtZSBkYXRhLiBUaGUgZm91ciB0b3AtcmFua2VkIG1vZGVscyBhY2hpZXZlZCBvdmVyYWxsIHZhbGlkYXRpb24NCiAgQy1pbmRpY2VzIG9mIDAuNTYgdG8gMC42MCBhbmQgc2hhcmVkIGFudGljb3JyZWxhdGlvbiB3aXRoIGV4cHJlc3Npb24gb2YgaW1tdW5lDQogIHJlc3BvbnNlIHBhdGh3YXlzLiBNb3N0IG1vZGVscyBkZW1vbnN0cmF0ZWQgbG93ZXIgYWNjdXJhY3kgaW4gbmV3IGRhdGFzZXRzDQogIHRoYW4gaW4gdmFsaWRhdGlvbiBzZXRzIHByZXNlbnRlZCBpbiB0aGVpciBwdWJsaWNhdGlvbi4gQ09OQ0xVU0lPTlM6IFRoaXMNCiAgYW5hbHlzaXMgcHJvdmlkZXMgZGVmaW5pdGl2ZSBzdXBwb3J0IGZvciBhIGhhbmRmdWwgb2YgcHJvZ25vc3RpYyBtb2RlbHMgYnV0DQogIGFsc28gY29uZmlybXMgdGhhdCB0aGVzZSByZXF1aXJlIGltcHJvdmVtZW50IHRvIGJlIG9mIGNsaW5pY2FsIHZhbHVlLiBUaGlzDQogIHdvcmsgYWRkcmVzc2VzIG91dHN0YW5kaW5nIGNvbnRyb3ZlcnNpZXMgaW4gdGhlIG92YXJpYW4gY2FuY2VyIGxpdGVyYXR1cmUgYW5kDQogIHByb3ZpZGVzIGEgcmVwcm9kdWNpYmxlIGZyYW1ld29yayBmb3IgbWV0YS1hbmFseXRpYyBldmFsdWF0aW9uIG9mIGdlbmUNCiAgc2lnbmF0dXJlcy59LA0KICB1cmwgPSB7aHR0cHM6Ly9hY2FkZW1pYy5vdXAuY29tL2puY2kvYXJ0aWNsZS1hYnN0cmFjdC8xMDYvNS9kanUwNDkvMjYwNjk3OX0sDQogIGxhbmd1YWdlID0ge2VufQ0KfQ0KDQpAQVJUSUNMRXtHYW56ZnJpZWQyMDEzLXV0LA0KICB0aXRsZSA9IHtjdXJhdGVkT3ZhcmlhbkRhdGE6IGNsaW5pY2FsbHkgYW5ub3RhdGVkIGRhdGEgZm9yIHRoZSBvdmFyaWFuIGNhbmNlcg0KICB0cmFuc2NyaXB0b21lfSwNCiAgYXV0aG9yID0ge0dhbnpmcmllZCwgQmVuamFtaW4gRnJlZGVyaWNrIGFuZCBSaWVzdGVyLCBNYXJrdXMgYW5kIEhhaWJlLUthaW5zLA0KICBCZW5qYW1pbiBhbmQgUmlzY2gsIFRob21hcyBhbmQgVHlla3VjaGV2YSwgU3ZpdGxhbmEgYW5kIEphemljLCBJbmEgYW5kIFdhbmcsDQogIFhpbiBWaWN0b3JpYSBhbmQgQWhtYWRpZmFyLCBNYWhuYXogYW5kIEJpcnJlciwgTWljaGFlbCBKIGFuZCBQYXJtaWdpYW5pLA0KICBHaW92YW5uaSBhbmQgSHV0dGVuaG93ZXIsIEN1cnRpcyBhbmQgV2FsZHJvbiwgTGV2aX0sDQogIGpvdXJuYWx0aXRsZSA9IHtEYXRhYmFzZSAoT3hmb3JkKX0sDQogIHB1Ymxpc2hlciA9IHtPeGZvcmQgVW5pdmVyc2l0eSBQcmVzcyAoT1VQKX0sDQogIHZvbHVtZSA9IHsyMDEzfSwNCiAgcGFnZXMgPSB7YmF0MDEzfSwNCiAgZGF0ZSA9IHsyMDEzLTA0LTAyfSwNCiAgZG9pID0gezEwLjEwOTMvZGF0YWJhc2UvYmF0MDEzfSwNCiAgcG1jID0ge1BNQzM2MjU5NTR9LA0KICBwbWlkID0gezIzNTUwMDYxfSwNCiAgaXNzbiA9IHsxNzU4LTA0NjN9LA0KICBhYnN0cmFjdCA9IHtUaGlzIGFydGljbGUgaW50cm9kdWNlcyBhIG1hbnVhbGx5IGN1cmF0ZWQgZGF0YSBjb2xsZWN0aW9uIGZvcg0KICBnZW5lIGV4cHJlc3Npb24gbWV0YS1hbmFseXNpcyBvZiBwYXRpZW50cyB3aXRoIG92YXJpYW4gY2FuY2VyIGFuZCBzb2Z0d2FyZSBmb3INCiAgcmVwcm9kdWNpYmxlIHByZXBhcmF0aW9uIG9mIHNpbWlsYXIgZGF0YWJhc2VzLiBUaGlzIHJlc291cmNlIHByb3ZpZGVzDQogIHVuaWZvcm1seSBwcmVwYXJlZCBtaWNyb2FycmF5IGRhdGEgZm9yIDI5NzAgcGF0aWVudHMgZnJvbSAyMyBzdHVkaWVzIHdpdGgNCiAgY3VyYXRlZCBhbmQgZG9jdW1lbnRlZCBjbGluaWNhbCBtZXRhZGF0YS4gSXQgYWxsb3dzIHVzZXJzIHRvIGVmZmljaWVudGx5DQogIGlkZW50aWZ5IHN0dWRpZXMgYW5kIHBhdGllbnQgc3ViZ3JvdXBzIG9mIGludGVyZXN0IGZvciBhbmFseXNpcyBhbmQgdG8gcGVyZm9ybQ0KICBtZXRhLWFuYWx5c2lzIGltbWVkaWF0ZWx5IHdpdGhvdXQgdGhlIGNoYWxsZW5nZXMgcG9zZWQgYnkgaGFybW9uaXppbmcNCiAgaGV0ZXJvZ2VuZW91cyBtaWNyb2FycmF5IHRlY2hub2xvZ2llcywgc3R1ZHkgZGVzaWducywgZXhwcmVzc2lvbiBkYXRhDQogIHByb2Nlc3NpbmcgbWV0aG9kcyBhbmQgY2xpbmljYWwgZGF0YSBmb3JtYXRzLiBXZSBjb25maXJtIHRoYXQgdGhlIHJlY2VudGx5DQogIHByb3Bvc2VkIGJpb21hcmtlciBDWENMMTIgaXMgYXNzb2NpYXRlZCB3aXRoIHBhdGllbnQgc3Vydml2YWwsIGluZGVwZW5kZW50bHkNCiAgb2Ygc3RhZ2UgYW5kIG9wdGltYWwgc3VyZ2ljYWwgZGVidWxraW5nLCB3aGljaCB3YXMgcG9zc2libGUgb25seSB0aHJvdWdoDQogIG1ldGEtYW5hbHlzaXMgb3dpbmcgdG8gaW5zdWZmaWNpZW50IHNhbXBsZSBzaXplcyBvZiB0aGUgaW5kaXZpZHVhbCBzdHVkaWVzLg0KICBUaGUgZGF0YWJhc2UgaXMgaW1wbGVtZW50ZWQgYXMgdGhlIGN1cmF0ZWRPdmFyaWFuRGF0YSBCaW9jb25kdWN0b3IgcGFja2FnZSBmb3INCiAgdGhlIFIgc3RhdGlzdGljYWwgY29tcHV0aW5nIGxhbmd1YWdlLCBwcm92aWRpbmcgYSBjb21wcmVoZW5zaXZlIGFuZCBmbGV4aWJsZQ0KICByZXNvdXJjZSBmb3IgY2xpbmljYWxseSBvcmllbnRlZCBpbnZlc3RpZ2F0aW9uIG9mIHRoZSBvdmFyaWFuIGNhbmNlcg0KICB0cmFuc2NyaXB0b21lLiBUaGUgcGFja2FnZSBhbmQgcGlwZWxpbmUgZm9yIHByb2R1Y2luZyBpdCBhcmUgYXZhaWxhYmxlIGZyb20NCiAgaHR0cDovL2JjYi5kZmNpLmhhcnZhcmQuZWR1L292YXJpYW5jYW5jZXIufSwNCiAgdXJsID0ge2h0dHBzOi8vYWNhZGVtaWMub3VwLmNvbS9kYXRhYmFzZS9hcnRpY2xlL2RvaS8xMC4xMDkzL2RhdGFiYXNlL2JhdDAxMy8zMzA5Nzg/dmlldz1sb25nfSwNCiAgbGFuZ3VhZ2UgPSB7ZW59DQp9DQoNCkBBUlRJQ0xFe1BhdGlsMjAxOC1obSwNCiAgdGl0bGUgPSB7VHJhaW5pbmcgcmVwbGljYWJsZSBwcmVkaWN0b3JzIGluIG11bHRpcGxlIHN0dWRpZXN9LA0KICBhdXRob3IgPSB7UGF0aWwsIFByYXNhZCBhbmQgUGFybWlnaWFuaSwgR2lvdmFubml9LA0KICBqb3VybmFsdGl0bGUgPSB7UHJvYy4gTmF0bC4gQWNhZC4gU2NpLiBVLiBTLiBBLn0sDQogIHB1Ymxpc2hlciA9IHtOYXRpb25hbCBBY2FkZW15IG9mIFNjaWVuY2VzfSwNCiAgdm9sdW1lID0gezExNX0sDQogIGlzc3VlID0gezExfSwNCiAgcGFnZXMgPSB7MjU3OC0yNTgzfSwNCiAgZGF0ZSA9IHsyMDE4LTAzLTEzfSwNCiAgZG9pID0gezEwLjEwNzMvcG5hcy4xNzA4MjgzMTE1fSwNCiAgcG1jID0ge1BNQzU4NTY1MDR9LA0KICBwbWlkID0gezI5NTMxMDYwfSwNCiAgaXNzbiA9IHswMDI3LTg0MjQsMTA5MS02NDkwfSwNCiAgYWJzdHJhY3QgPSB7VGhpcyBhcnRpY2xlIGNvbnNpZGVycyByZXBsaWNhYmlsaXR5IG9mIHRoZSBwZXJmb3JtYW5jZSBvZg0KICBwcmVkaWN0b3JzIGFjcm9zcyBzdHVkaWVzLiBXZSBzdWdnZXN0IGEgZ2VuZXJhbCBhcHByb2FjaCB0byBpbnZlc3RpZ2F0aW5nIHRoaXMNCiAgaXNzdWUsIGJhc2VkIG9uIGVuc2VtYmxlcyBvZiBwcmVkaWN0aW9uIG1vZGVscyB0cmFpbmVkIG9uIGRpZmZlcmVudCBzdHVkaWVzLg0KICBXZSBxdWFudGlmeSBob3cgdGhlIGNvbW1vbiBwcmFjdGljZSBvZiB0cmFpbmluZyBvbiBhIHNpbmdsZSBzdHVkeSBhY2NvdW50cyBpbg0KICBwYXJ0IGZvciB0aGUgb2JzZXJ2ZWQgY2hhbGxlbmdlcyBpbiByZXBsaWNhYmlsaXR5IG9mIHByZWRpY3Rpb24gcGVyZm9ybWFuY2UuDQogIFdlIGFsc28gaW52ZXN0aWdhdGUgd2hldGhlciBlbnNlbWJsZXMgb2YgcHJlZGljdG9ycyB0cmFpbmVkIG9uIG11bHRpcGxlDQogIHN0dWRpZXMgY2FuIGJlIGNvbWJpbmVkLCB1c2luZyB1bmlxdWUgY3JpdGVyaWEsIHRvIGRlc2lnbiByb2J1c3QgZW5zZW1ibGUNCiAgbGVhcm5lcnMgdHJhaW5lZCB1cGZyb250IHRvIGluY29ycG9yYXRlIHJlcGxpY2FiaWxpdHkgaW50byBkaWZmZXJlbnQgY29udGV4dHMNCiAgYW5kIHBvcHVsYXRpb25zLn0sDQogIHVybCA9IHtodHRwOi8vZHguZG9pLm9yZy8xMC4xMDczL3BuYXMuMTcwODI4MzExNX0sDQogIHVybGRhdGUgPSB7MjAyMy0wOC0yMn0sDQogIGtleXdvcmRzID0ge2Nyb3NzLXN0dWR5IHZhbGlkYXRpb247IGVuc2VtYmxlIGxlYXJuaW5nOyBtYWNoaW5lIGxlYXJuaW5nOw0KICByZXBsaWNhYmlsaXR5OyB2YWxpZGF0aW9uO3JlcGxpY2F0aW9uLXN1bW1lci1zY2hvb2wtMjAyM30sDQogIGxhbmd1YWdlID0ge2VufQ0KfQ0KDQo=" download="refs_to_download.bib"> Download .bib file</a></button></h2>
<p><br></p>
<div class="footer footer-default">

</div>
<div id="refs" class="references csl-bib-body hanging-indent" data-line-spacing="2" role="list">
<div id="ref-Brenner1997-yq" class="csl-entry" role="listitem">
Brenner, H., &amp; Gefeller, O. (1997). Variation of sensitivity, specificity, likelihood ratios and predictive values with disease prevalence. <em>Stat. Med.</em>, <em>16</em>, 981–991. <a href="https://doi.org/10.1002/(sici)1097-0258(19970515)16:9<981::aid-sim510>3.0.co;2-n">https://doi.org/10.1002/(sici)1097-0258(19970515)16:9&lt;981::aid-sim510&gt;3.0.co;2-n</a>
</div>
<div id="ref-Carpenter2000-dm" class="csl-entry" role="listitem">
Carpenter, J., &amp; Bithell, J. (2000). Bootstrap confidence intervals: When, which, what? A practical guide for medical statisticians. <em>Stat. Med.</em>, <em>19</em>, 1141–1164. <a href="https://doi.org/10.1002/(sici)1097-0258(20000515)19:9<1141::aid-sim479>3.0.co;2-f">https://doi.org/10.1002/(sici)1097-0258(20000515)19:9&lt;1141::aid-sim479&gt;3.0.co;2-f</a>
</div>
<div id="ref-Ganzfried2013-ut" class="csl-entry" role="listitem">
Ganzfried, B. F., Riester, M., Haibe-Kains, B., Risch, T., Tyekucheva, S., Jazic, I., Wang, X. V., Ahmadifar, M., Birrer, M. J., Parmigiani, G., Huttenhower, C., &amp; Waldron, L. (2013). curatedOvarianData: Clinically annotated data for the ovarian cancer transcriptome. <em>Database (Oxford)</em>, <em>2013</em>, bat013. <a href="https://doi.org/10.1093/database/bat013">https://doi.org/10.1093/database/bat013</a>
</div>
<div id="ref-Masoero2023-wb" class="csl-entry" role="listitem">
Masoero, L., Thomas, E., Parmigiani, G., Tyekucheva, S., &amp; Trippa, L. (2023). Cross-study replicability in cluster analysis. <em>Stat. Sci.</em>, <em>38</em>, 303–316. <a href="https://doi.org/10.1214/22-sts871">https://doi.org/10.1214/22-sts871</a>
</div>
<div id="ref-Parmigiani2023-dr" class="csl-entry" role="listitem">
Parmigiani, G. (2023). Defining replicability of prediction rules. In <em>arXiv [stat.ME]</em>. <a href="http://arxiv.org/abs/2305.01518">http://arxiv.org/abs/2305.01518</a>
</div>
<div id="ref-Patil2018-hm" class="csl-entry" role="listitem">
Patil, P., &amp; Parmigiani, G. (2018). Training replicable predictors in multiple studies. <em>Proc. Natl. Acad. Sci. U. S. A.</em>, <em>115</em>, 2578–2583. <a href="https://doi.org/10.1073/pnas.1708283115">https://doi.org/10.1073/pnas.1708283115</a>
</div>
<div id="ref-Waldron2014-yv" class="csl-entry" role="listitem">
Waldron, L., Haibe-Kains, B., Culhane, A. C., Riester, M., Ding, J., Wang, X. V., Ahmadifar, M., Tyekucheva, S., Bernau, C., Risch, T., Ganzfried, B. F., Huttenhower, C., Birrer, M., &amp; Parmigiani, G. (2014). Comparative meta-analysis of prognostic gene signatures for late-stage ovarian cancer. <em>J. Natl. Cancer Inst.</em>, <em>106</em>, dju049. <a href="https://doi.org/10.1093/jnci/dju049">https://doi.org/10.1093/jnci/dju049</a>
</div>
</div>
</section></section>

<!-- FINAL SLIDE -->


<!-- END FINAL SLIDE -->

    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="03-biostatistics_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="03-biostatistics_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="03-biostatistics_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="03-biostatistics_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="03-biostatistics_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="03-biostatistics_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="03-biostatistics_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="03-biostatistics_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="03-biostatistics_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="03-biostatistics_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: false,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    
</body></html>